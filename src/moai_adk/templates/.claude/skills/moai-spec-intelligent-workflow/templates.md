# 3단계 SPEC 템플릿

**작성일**: 2025-11-21
**상태**: Production Ready

---

## 개요

Alfred의 판단 결과에 따라 다음 3가지 템플릿 중 하나가 **자동으로 선택**됩니다:

| 레벨 | 대상 | 파일 수 | 시간 | 섹션 |
|------|------|--------|------|------|
| **Level 1** | 단순 작업 | 1-2개 | 5-10분 | 5개 |
| **Level 2** | 일반 기능 | 3-5개 | 10-15분 | 7개 (EARS) |
| **Level 3** | 복잡한 작업 | 5개+ | 20-30분 | 10+ |

---

## Level 1: Minimal (간단한 작업용)

### 적용 대상
- 버그 수정
- 간단한 기능 추가
- 문서 업데이트
- 의존성 업그레이드

### 템플릿 구조

```markdown
# SPEC-XXX: [제목]

## 1. 개요
한두 문장으로 요구사항 요약

## 2. 현재 상황 (문제점)
- 문제 1
- 문제 2

## 3. 해결 방안
- 방안 1
- 방안 2

## 4. 검증 기준
- [ ] 테스트 케이스 1
- [ ] 테스트 케이스 2

## 5. 종료 조건
- 완료 기준: [명확한 기준]
```

### 실제 예제: 로그인 한글 메시지

```markdown
# SPEC-001: 로그인 페이지 한글 메시지 표시 오류 수정

## 1. 개요
로그인 페이지의 에러 메시지가 영어로만 표시되는 버그를 수정합니다.

## 2. 현재 상황
- 에러 메시지: "Invalid credentials" (영어만)
- i18n 설정에 한글 번역 누락

## 3. 해결 방안
1. `/src/i18n/messages.json`에 한글 번역 추가
2. 로그인 폼에서 i18n 함수 사용 확인

## 4. 검증 기준
- [ ] 한국어 브라우저: 한글 메시지 표시
- [ ] 영어 브라우저: 영어 메시지 표시
- [ ] 기존 기능 깨짐 없음

## 5. 종료 조건
- 로그인 실패 시 사용자 브라우저 언어에 따라 메시지 표시
```

---

## Level 2: Standard (일반 기능용)

### 적용 대상
- 일반적인 기능 개발
- 여러 파일 수정 필요
- 기본적인 컴포넌트 통합

### 템플릿 구조 (EARS 형식)

```markdown
# SPEC-XXX: [제목]

## 📋 SPEC 메타데이터
| 항목 | 값 |
|------|-----|
| ID | SPEC-XXX |
| 제목 | [제목] |
| 복잡도 | MEDIUM |
| 예상 시간 | [시간]시간 |
| 우선순위 | HIGH/MEDIUM/LOW |

## 1. 개요 (Overview)

### 목표
- 달성할 목표 1
- 달성할 목표 2

### 범위
- 포함: [범위 내 항목]
- 제외: [범위 외 항목]

## 2. 평가 기준 (Evaluation)

### 기능 요구사항
1. REQ-1: [상세 요구사항]
2. REQ-2: [상세 요구사항]

### 비기능 요구사항
1. NFREQ-1: [성능/보안]
2. NFREQ-2: [확장성]

## 3. 분석 (Analysis)

### 현재 상황
- [현재 시스템 상태]
- [문제점]

### 고려사항
- [기술적 제약]
- [의존성]

## 4. 권장사항 (Recommendation)

### 제안된 솔루션
- [솔루션 개요]
- [기술 스택]

### 대안 검토
- 대안 1: [장점/단점]
- 대안 2: [장점/단점]

## 5. 종합 분석 (Synthesis)

### 구현 전략
1. Phase 1: [단계 1]
2. Phase 2: [단계 2]

### 리스크 관리
- Risk 1: [대응 방안]
- Risk 2: [대응 방안]

## 6. 검증 기준

### 기능 검증
- [ ] [검증 항목 1]
- [ ] [검증 항목 2]

### 품질 검증
- [ ] 테스트 커버리지 85% 이상
- [ ] 코드 리뷰 승인됨

## 7. 종료 조건

### Definition of Done
- 모든 검증 기준 충족
- 테스트 통과
- 코드 리뷰 승인
- 문서 작성 완료
```

### 실제 예제: 프로필 이미지 업로드

```markdown
# SPEC-003: 사용자 프로필 이미지 업로드 기능

## 📋 SPEC 메타데이터
| 항목 | 값 |
|------|-----|
| ID | SPEC-003 |
| 제목 | 사용자 프로필 이미지 업로드 |
| 복잡도 | MEDIUM |
| 예상 시간 | 2시간 |
| 우선순위 | HIGH |

## 1. 개요

### 목표
- 사용자가 프로필 사진을 업로드할 수 있도록 구현
- 이미지 최적화 및 캐싱 처리
- 데이터베이스에 안전하게 저장

### 범위
- 포함: 프로필 페이지 수정, 백엔드 API, 데이터베이스
- 제외: 이미지 편집 기능, 갤러리 관리

## 2. 평가 기준

### 기능 요구사항
1. REQ-1: 사용자는 프로필 페이지에서 이미지 업로드 가능
2. REQ-2: 이미지는 JPEG/PNG 형식만 지원 (최대 5MB)
3. REQ-3: 업로드된 이미지는 자동으로 최적화됨 (1024x1024)
4. REQ-4: 기존 이미지는 새로운 이미지로 교체됨

### 비기능 요구사항
1. NFREQ-1: 이미지 업로드는 3초 이내 완료
2. NFREQ-2: 이미지는 CDN에 캐싱됨
3. NFREQ-3: 사용자 개인정보 보호

## 3. 분석

### 현재 상황
- 프로필 기본 정보만 저장 (이름, 이메일)
- 이미지 업로드 기능 없음

### 고려사항
- 프로필 테이블에 image_url 컬럼 추가 필요
- 파일 저장소 (S3 또는 로컬) 구성
- 이미지 최적화 라이브러리 필요

## 4. 권장사항

### 제안된 솔루션
- 백엔드: Node.js + Express + multer
- 이미지 처리: Sharp 라이브러리
- 저장소: AWS S3

### 대안 검토
- 대안 1: Google Drive API - 복잡도 높음
- 대안 2: 로컬 저장소 - 확장성 낮음

## 5. 종합 분석

### 구현 전략
1. Phase 1: DB 스키마 수정
2. Phase 2: 백엔드 API 구현
3. Phase 3: 프론트엔드 UI 추가

### 리스크 관리
- Risk 1: 대용량 파일 → 청크 업로드 구현
- Risk 2: 악성 파일 → 파일 검증 로직 추가

## 6. 검증 기준

### 기능 검증
- [ ] 파일 선택 가능
- [ ] JPEG/PNG만 수락
- [ ] 이미지 최적화 확인
- [ ] 동시 업로드 지원

### 품질 검증
- [ ] 테스트 커버리지 85% 이상
- [ ] 코드 리뷰 승인됨

## 7. 종료 조건
- 모든 검증 기준 충족
- 프로덕션 배포 가능
```

---

## Level 3: Comprehensive (복잡한 작업용)

### 적용 대상
- 아키텍처 변경
- 대규모 데이터 모델 수정
- 여러 컴포넌트의 복잡한 통합
- 마이그레이션 작업

### 템플릿 구조

Level 2의 모든 섹션 + 다음 추가:

```markdown
## 6. 아키텍처 설계 (NEW)

### 시스템 다이어그램
[ASCII 다이어그램]

### 컴포넌트 상호작용
- [컴포넌트 1] → [컴포넌트 2]

## 7. 마이그레이션 전략 (NEW)

### 단계별 실행 계획
1. Phase 1: [상세]
2. Phase 2: [상세]
3. Phase 3: [상세]

### 롤백 계획
- [롤백 시나리오]

## 8. 성능 고려사항 (NEW)

### 성능 목표
- [기준 1]
- [기준 2]

## 9. 보안 고려사항 (NEW)

### 보안 요구사항
- [요구사항 1]

### 위협 모델
- [위협 1] → [대응]

## 10. 검증 기준
[Level 2보다 더 상세함]

## 11. 종료 조건
[Level 2와 유사]
```

---

## 템플릿 자동 선택 로직

Alfred는 다음 규칙에 따라 자동으로 선택:

```python
if complexity_assessment['strength'] == 'low':
    template = Level1_Minimal
elif complexity_assessment['strength'] == 'medium':
    template = Level2_Standard
else:  # 'high'
    template = Level3_Comprehensive
```

### 선택 기준

| 복잡도 | 특징 | 템플릿 |
|--------|------|--------|
| 낮음 (LOW) | 1-2 파일, 30분 이내 | Level 1 |
| 중간 (MEDIUM) | 3-5 파일, 1-2시간, 기본 통합 | Level 2 |
| 높음 (HIGH) | 5개+ 파일, 2시간+, 아키텍처 변경 | Level 3 |

---

## 템플릿 사용 흐름

### Step 1: 사용자 요청
```
"사용자 프로필 이미지 업로드 기능을 추가해주세요"
```

### Step 2: Alfred 판단
```
복잡도: MEDIUM
→ Level 2 (Standard) 템플릿 선택
```

### Step 3: SPEC 자동 생성
spec-builder가 Level 2 템플릿을 채워서 SPEC 생성

### Step 4: 사용자 검토
사용자가 생성된 SPEC을 검토하고 필요하면 수정

### Step 5: 구현 시작
```bash
/moai:2-run SPEC-XXX
```

---

## 각 템플릿의 AI 보조 비율

| 단계 | Level 1 | Level 2 | Level 3 |
|------|---------|---------|---------|
| 초안 생성 | 90% | 75% | 60% |
| 내용 검토 | 80% | 70% | 50% |
| 최종 완성 | 70% | 60% | 40% |
| **평균** | **80%** | **68%** | **50%** |

---

## 템플릿 작성 시간 비교

| 활동 | Level 1 | Level 2 | Level 3 |
|------|---------|---------|---------|
| AI 생성 (80%) | 2-4분 | 4-8분 | 8-12분 |
| 사용자 검토 (20%) | 1-2분 | 2-4분 | 5-8분 |
| **총 시간** | **5-10분** | **10-15분** | **20-30분** |

---

## 템플릿 선택 예제

### 예제 1: 버그 수정 → Level 1

```
작업: "버튼 색상 변경"
파일: 1개 (CSS)
시간: 5분
복잡도: LOW

→ Level 1 선택 (5-10분 작성)
```

### 예제 2: 기능 추가 → Level 2

```
작업: "사용자 프로필 이미지 업로드"
파일: 4개 (API, Frontend, DB, Middleware)
시간: 2시간
복잡도: MEDIUM

→ Level 2 선택 (10-15분 작성)
```

### 예제 3: 아키텍처 변경 → Level 3

```
작업: "마이크로서비스 아키텍처로 마이그레이션"
파일: 15개 이상
시간: 1주일 이상
복잡도: HIGH

→ Level 3 선택 (20-30분 작성)
```

---

## 템플릿 주요 특징

### ✅ Level 1 (Minimal)
- 빠르고 간결
- 필수 정보만 포함
- 프로토타입 수정에 최적

### ✅ Level 2 (Standard)
- EARS 형식 준수
- 일반 기능 개발에 최적
- 충분한 구조와 유연성

### ✅ Level 3 (Comprehensive)
- 아키텍처 설계 포함
- 복잡한 프로젝트에 최적
- 상세한 리스크 관리

---

## FAQ

**Q: 템플릿을 수정할 수 있나요?**
A: 네, 생성된 SPEC은 언제든지 수정 가능합니다. 필요한 섹션을 추가하거나 제거해도 됩니다.

**Q: 작업 중 복잡도가 변하면?**
A: Alfred가 감지하면 더 높은 레벨 템플릿으로 전환을 제안합니다.

**Q: Level 1도 테스트를 써야 하나요?**
A: 네, 모든 레벨에서 테스트는 필수입니다. 다만 Level 1은 간단한 단위 테스트만, Level 3은 통합 테스트까지 포함합니다.

---

**문서 버전**: 1.0.0
**마지막 업데이트**: 2025-11-21
**상태**: Production Ready
