---
title: "PLAN-MIGRATION-001: Next.js 16 + Nextra 4.6.0 마이그레이션 실행 계획"
version: "1.0.0"
date: "2025-01-10"
author: "Alfred"
status: "draft"
---


## 📋 TAG BLOCK

```

```

## 🎯 개요

이 문서는 Next.js 16 + Nextra 4.6.0 통합 마이그레이션의 상세 실행 계획을 정의합니다. 12단계 마이그레이션 프로세스를 기술적 접근 방식, 리소스 배분, 위험 관리 전략과 함께 제시합니다.

## 📅 12단계 실행 계획

### Phase 1: 준비 및 분석 (1-2일)

#### 목표
- 현재 프로젝트 구조와 의존성 심층 분석
- Next.js 16 + Nextra 4.6.0 호환성 검증
- 상세 마이그레이션 로드맵 수립
- 포괄적인 롤백 전략 수립

#### 세부 실행 항목
1. **프로젝트 구조 분석**
   - 현재 Nextra 3.3.1 설정 분석
   - MDX 파일 구조와 플러그인 의존성 파악
   - 빌드 및 배포 파이프라인 분석
   - 성능 기준선(baseline) 측정

2. **호환성 검증**
   - Next.js 16 업그레이드 경로 검토
   - React 19 변경사항 영향 분석
   - Nextra 4.6.0 마이그레이션 가이드 검토
   - 의존성 패키지 호환성 매트릭스 작성

3. **마이그레이션 계획 상세화**
   - 각 Phase별 구체적인 실행 계획
   - 필요한 스크립트와 도구 준비
   - 성능 목표 측정 방법 정의
   - 성공 기준 명확화

4. **롤백 전략 수립**
   - Git 브랜치 전략 수립
   - 백업 및 복원 절차 정의
   - 롤백 결정 기준 설정
   - 롤백 테스트 시나리오 준비

#### 예상 결과물
- 프로젝트 분석 보고서
- 호환성 검증 보고서
- 상세 실행 계획서
- 롤백 전략 문서

### Phase 2: 의존성 업그레이드 (1일)

#### 목표
- package.json 의존성 버전 업데이트
- 호환성 문제 조기 발견 및 해결
- 개발 환경 재설정
- 초기 빌드 성공 확인

#### 세부 실행 항목
1. **package.json 업데이트**
   ```json
   {
     "dependencies": {
       "next": "^16.0.0",
       "react": "^19.0.0",
       "react-dom": "^19.0.0",
       "nextra": "^4.6.0",
       "nextra-theme-docs": "^4.6.0"
     },
     "devDependencies": {
       "pagefind": "^1.0.0",
       "@next/bundle-analyzer": "^15.0.0"
     }
   }
   ```

2. **의존성 설치 및 충돌 해결**
   - `npm install` 또는 `yarn install` 실행
   - 의존성 충돌 문제 해결
   - TypeScript 버전 호환성 확인
   - ESLint, Prettier 설정 업데이트

3. **개발 환경 설정**
   - next.config.cjs → next.config.mjs 변환
   - TypeScript 설정 업데이트
   - 개발 서버 시작 테스트
   - HMR(Hot Module Replacement) 동작 확인

4. **초기 빌드 테스트**
   - 개발 모드 빌드 성공 확인
   - 프로덕션 빌드 시도 및 오류 파악
   - 빌드 로그 분석 및 문제점 식별
   - 기본 페이지 렌더링 확인

#### 예상 결과물
- 업데이트된 package.json
- 개발 환경 설정 완료
- 초기 빌드 성공 확인
- 발견된 문제점 목록

### Phase 3: 프로젝트 구조 재설계 (2-3일)

#### 목표
- Pages Router → App Router 완전 전환
- 새로운 레이아웃 구조 설계
- 동적 라우팅 설정
- 미들웨어 및 API 라우트 마이그레이션

#### 세부 실행 항목
1. **App Router 구조 설계**
   ```
   docs/
   ├── app/
   │   ├── layout.tsx          # 루트 레이아웃
   │   ├── page.tsx            # 홈페이지
   │   ├── globals.css         # 전역 스타일
   │   ├── [lang]/
   │   │   ├── layout.tsx      # 언어별 레이아웃
   │   │   ├── page.tsx        # 언어별 홈
   │   │   └── [...slug]/
   │   │       └── page.tsx    # 동적 라우팅
   │   └── api/
   │       └── search/
   │           └── route.ts    # 검색 API
   ├── components/
   ├── lib/
   └── src/
   ```

2. **레이아웃 컴포넌트 마이그레이션**
   - `_app.tsx` → `layout.tsx` 변환
   - `_document.tsx` → 루트 레이아웃 통합
   - 언어별 레이아웃 설계
   - 테마 및 스타일 시스템 통합

3. **페이지 라우팅 설정**
   - 동적 라우팅 `[...slug]` 구현
   - 정적 페이지 생성 설정
   - 언어별 라우팅 규칙 정의
   - 404 페이지 처리

4. **미들웨어 및 API 라우트**
   - `middleware.ts` 설정 업데이트
   - API 라우트 `app/api/` 구조로 변환
   - 언어 감지 및 리다이렉션 로직
   - 보안 헤더 설정

#### 예상 결과물
- 완전한 App Router 구조
- 마이그레이션된 레이아웃 컴포넌트
- 동작하는 라우팅 시스템
- API 라우트 구현

### Phase 4: Nextra 4.6.0 설정 마이그레이션 (2일)

#### 목표
- Nextra 3.3.1 → 4.6.0 설정 완전 전환
- 새로운 테마 시스템 적용
- 플러그인 호환성 확보
- MDX 처리 파이프라인 설정

#### 세부 실행 항목
1. **next.config.mjs 설정**
   ```typescript
   import { Nextra } from 'nextra'

   const withNextra = Nextra({
     theme: 'nextra-theme-docs',
     themeConfig: './theme.config.tsx',
     latex: true,
     defaultShowCopyCode: true,
     readingTime: true,
     mdxOptions: {
       lastModifiedTime: 'git',
       flexsearch: {
         codeblocks: false
       }
     }
   })

   export default withNextra({
     experimental: {
       turbo: {
         loaders: {
           '.svg': ['@svgr/webpack']
         }
       }
     },
     images: {
       formats: ['image/webp', 'image/avif']
     }
   })
   ```

2. **테마 설정 업데이트**
   - `theme.config.tsx` 마이그레이션
   - 새로운 테마 옵션 적용
   - 다국어 설정 통합
   - 네비게이션 구조 설정

3. **플러그인 설정 마이그레이션**
   - remark 플러그인 호환성 확인
   - rehype 플러그인 업데이트
   - MDX 컴포넌트 설정
   - 커스텀 플러그인 변환

4. **MDX 처리 파이프라인**
   - MDX 컴파일러 설정
   - 컴포넌트 임포트 방식 변경
   - 프론트매터 처리
   - 코드 블록 하이라이팅

#### 예상 결과물
- 완전한 Nextra 4.6.0 설정
- 동작하는 테마 시스템
- 호환되는 플러그인 세트
- 정상 작동하는 MDX 파이프라인

### Phase 5: 다국어 콘텐츠 호환성 (2-3일)

#### 목표
- 100+ MDX 파일 완전 호환성 확보
- 4개 언어(ko, en, ja, zh) 지원 유지
- 언어별 레이아웃 최적화
- 콘텐츠 렌더링 검증

#### 세부 실행 항목
1. **MDX 파일 형식 검증**
   - 기존 MDX 파일 구조 분석
   - 호환성 문제 식별 및 해결
   - 프론트매터 형식 표준화
   - 임포트 경로 업데이트

2. **언어별 레이아웃 설정**
   - 언어별 폰트 및 타이포그래피
   - RTL(Right-to-Left) 언어 지원 검토
   - 언어 스위치 컴포넌트
   - 번역 상태 표시

3. **다국어 라우팅 최적화**
   - `[lang]` 동적 세그먼트 설정
   - 기본 언어 리다이렉션
   - 언어별 사이트맵 생성
   - hreflang 태그 설정

4. **콘텐츠 렌더링 테스트**
   - 각 언어별 페이지 렌더링 확인
   - 특수 문자 및 이모지 처리
   - 코드 블록 및 수식 렌더링
   - 이미지 및 미디어 콘텐츠

#### 예상 결과물
- 모든 언어에서 정상 작동하는 MDX 파일
- 최적화된 언어별 레이아웃
- 완전한 다국어 라우팅
- 콘텐츠 렌더링 검증 보고서

### Phase 6: 검색 엔진 전환 (2일)

#### 목표
- FlexSearch → Pagefind 완전 전환
- 4개 언어 검색 지원
- 검색 성능 30% 개선
- 실시간 검색 인덱싱

#### 세부 실행 항목
1. **Pagefind 설치 및 설정**
   ```bash
   npm install pagefind
   npx pagefind --source . --output-dir public/pagefind
   ```

2. **검색 인덱싱 설정**
   - 다국어 인덱싱 설정
   - 검색 필터 정의 (언어, 카테고리)
   - 커스텀 추출 규칙
   - 인덱스 최적화

3. **검색 API 구현**
   ```typescript
   // app/api/search/route.ts
   import { search } from '@/lib/pagefind'

   export async function GET(request: Request) {
     const { searchParams } = new URL(request.url)
     const query = searchParams.get('q')
     const language = searchParams.get('lang')

     const results = await search(query, { language })
     return Response.json(results)
   }
   ```

4. **검색 UI 컴포넌트**
   - Pagefind 검색 컴포넌트
   - 언어별 검색 결과 필터링
   - 실시간 검색 제안
   - 검색 결과 하이라이팅

#### 예상 결과물
- 완전한 Pagefind 통합
- 동작하는 다국어 검색
- 향상된 검색 성능
- 사용자 친화적 검색 UI

### Phase 7: Turbopack 도입 (1-2일)

#### 목표
- Turbopack 빌드 시스템 완전 도입
- 개발 환경 성능 최적화
- 프로덕션 빌드 설정
- 빌드 속도 50% 개선

#### 세부 실행 항목
1. **Turbopack 설정**
   ```typescript
   // next.config.mjs
   export default {
     experimental: {
       turbo: {
         rules: {
           '*.svg': {
             loaders: ['@svgr/webpack'],
             as: '*.js',
           },
         },
       },
     },
     webpack: (config, { isServer }) => {
       // 기존 webpack 설정 유지 필요시
       return config
     }
   }
   ```

2. **개발 환경 최적화**
   - `next dev --turbo` 설정
   - 핫 리로드 성능 측정
   - 메모리 사용량 최적화
   - 개발 서버 응답 속도

3. **프로덕션 빌드 설정**
   - `next build --turbo` 테스트
   - 빌드 캐시 최적화
   - 번들 분석 및 최적화
   - 에셋 최적화

4. **빌드 성능 테스트**
   - 빌드 시간 벤치마킹
   - 번들 크기 분석
   - 빌드 메모리 사용량
   - 병렬 빌드 성능

#### 예상 결과물
- Turbopack 빌드 시스템
- 최적화된 개발 환경
- 고성능 프로덕션 빌드
- 빌드 성능 개선 보고서

### Phase 8: 성능 최적화 (2-3일)

#### 목표
- LCP 25% 개선 (2.5초 → 1.9초)
- FCP 30% 개선 (1.8초 → 1.3초)
- Core Web Vitals 최적화
- 자동 이미지 최적화

#### 세부 실행 항목
1. **이미지 최적화**
   - `next/image` 컴포넌트 적용
   - WebP/AVIF 형식 자변환
   - 반응형 이미지 설정
   - 레이지 로딩 구현

2. **코드 스플리팅 최적화**
   - 동적 임포트 적용
   - 라우트별 코드 분할
   - 컴포넌트 레벨 분할
   - 번들 분석 및 최적화

3. **캐싱 전략**
   - 정적 에셋 캐싱
   - 페이지 수준 캐싱
   - CDN 캐시 설정
   - 브라우저 캐시 정책

4. **Core Web Vitals 최적화**
   - LCP(Largest Contentful Paint) 최적화
   - FID(First Input Delay) 개선
   - CLS(Cumulative Layout Shift) 제거
   - TTFB(Time to First Byte) 최적화

#### 예상 결과물
- 최적화된 이미지 처리
- 효율적인 코드 스플리팅
- 강력한 캐싱 시스템
- 향상된 Core Web Vitals

### Phase 9: 테스트 및 검증 (3-4일)

#### 목표
- 포괄적인 기능 테스트 수행
- 성능 목표 달성 검증
- 회귀 테스트 완료
- 사용자 수용 테스트

#### 세부 실행 항목
1. **기능 테스트**
   - 모든 페이지 렌더링 테스트
   - 언어 전환 기능 테스트
   - 검색 기능 테스트
   - 네비게이션 및 라우팅 테스트

2. **성능 테스트**
   - Lighthouse 성능 측정
   - WebPageTest 분석
   - 빌드 시간 측정
   - 모바일 성능 테스트

3. **회귀 테스트**
   - 기존 기능 호환성
   - SEO 메타데이터 유지
   - 애널리틱스 추적
   - 소셜 미디어 공유

4. **사용자 수용 테스트**
   - 다양한 브라우저 테스트
   - 모바일 기기 테스트
   - 접근성 테스트
   - 사용성 피드백 수집

#### 예상 결과물
- 포괄적인 테스트 보고서
- 성능 개선 검증
- 회귀 테스트 통과
- 사용자 피드백 요약

### Phase 10: 배포 준비 (1일)

#### 목표
- 프로덕션 빌드 완벽 검증
- 환경 설정 완료
- Vercel 설정 업데이트
- 배포 스크립트 준비

#### 세부 실행 항목
1. **프로덕션 빌드 검증**
   - `next build` 완전 성공
   - 빌드 경고 제거
   - 에셋 최적화 확인
   - 정적 파일 생성 검증

2. **환경 변수 설정**
   - 개발/프로덕션 환경 분리
   - API 키 및 시크릿 설정
   - 빌드 시간 환경 변수
   - 런타임 환경 변수

3. **Vercel 설정 업데이트**
   - 빌드 명령어 업데이트
   - Node.js 버전 설정
   - 환경 변수 등록
   - 도메인 및 SSL 설정

4. **배포 스크립트 준비**
   - 자동화된 배포 파이프라인
   - 롤백 스크립트
   - 상태 확인 스크립트
   - 알림 설정

#### 예상 결과물
- 프로덕션 준비된 빌드
- 완전한 환경 설정
- 업데이트된 Vercel 설정
- 자동화된 배포 시스템

### Phase 11: 점진적 배포 (1-2일)

#### 목표
- 안전한 스테이징 배포
- 최종 검증 및 테스트
- 성공적인 프로덕션 배포
- 포괄적인 모니터링

#### 세부 실행 항목
1. **스테이징 배포**
   - Preview 배포 실행
   - 모든 기능 검증
   - 성능 지표 측정
   - 문제점 조기 발견

2. **최종 검증**
   - 스테이징에서 최종 테스트
   - 모든 언어 확인
   - 검색 기능 검증
   - 성능 목표 달성 확인

3. **프로덕션 배포**
   - 메인 브랜치 배포
   - 실시간 모니터링
   - 에러 로그 확인
   - 사용자 피드백 모니터링

4. **모니터링 설정**
   - Vercel Analytics 설정
   - 성능 모니터링
   - 에러 추적
   - 사용자 행동 분석

#### 예상 결과물
- 성공적인 스테이징 배포
- 완료된 최종 검증
- 안정적인 프로덕션 배포
- 활성화된 모니터링 시스템

### Phase 12: 안정화 및 문서화 (1-2일)

#### 목표
- 시스템 안정화 모니터링
- 발생한 문제 해결
- 마이그레이션 문서화
- 운영 가이드 업데이트

#### 세부 실행 항목
1. **성능 모니터링**
   - 24시간 성능 관찰
   - 사용자 패턴 분석
   - 병목 현상 식별
   - 최적화 기회 발견

2. **문제 해결**
   - 발생한 이슈 해결
   - 사용자 피드백 반영
   - 버그 수정 및 패치
   - 성능 튜닝

3. **문서화**
   - 마이그레이션 과정 기록
   - 변경사항 상세 문서
   - 문제 해결 노하우
   - 운영 가이드 업데이트

4. **운영 가이드**
   - 새로운 빌드 프로세스
   - 배포 절차
   - 모니터링 가이드
   - 문제 해결 가이드

#### 예상 결과물
- 안정화된 시스템
- 해결된 모든 문제
- 완전한 마이그레이션 문서
- 업데이트된 운영 가이드

## 🎯 기술 접근 방식

### 아키텍처 전략
1. **점진적 마이그레이션**: 12단계로 나누어 점진적으로 진행
2. **호환성 우선**: 기존 기능을 먼저 보장하고 신규 기능 추가
3. **성능 중심**: 모든 단계에서 성능 개선을 우선 고려
4. **안정성 보장**: 롤백 전략과 단계별 검증으로 안정성 확보

### 리소스 배분
- **개발자 시간**: 총 20-25일 예상 (1개월 내외)
- **검증 시간**: 전체 기간의 30% 할당
- **문서화**: 마지막 10% 시간 할당
- **버퍼 시간**: 예상치 못한 문제를 위한 20% 버퍼

### 성공 기준
- 모든 Phase 100% 완료
- 성능 목표 100% 달성
- 회귀 테스트 100% 통과
- 사용자 만족도 95% 이상

## 🔍 추적성

### 관련 SPEC

### 관련 코드

### 관련 테스트
