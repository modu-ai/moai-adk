# SPEC-HOOKS-001 ìˆ˜ë½ ê¸°ì¤€ (Acceptance Criteria)

> **âœ… êµ¬í˜„ ì™„ë£Œ ìƒíƒœ (2025-10-16)**
>
> ì´ ë¬¸ì„œëŠ” **ì´ë¯¸ ì™„ë£Œëœ êµ¬í˜„ì˜ ìˆ˜ë½ ê¸°ì¤€**ì„ ì •ì˜í•©ë‹ˆë‹¤.
> 22ê°œ í…ŒìŠ¤íŠ¸ê°€ ëª¨ë‘ í†µê³¼í•˜ì—¬ ìˆ˜ë½ ê¸°ì¤€ì„ ì¶©ì¡±í•©ë‹ˆë‹¤.

---

## ìˆ˜ë½ ê¸°ì¤€ ê°œìš”

### ê¸°ëŠ¥ ì™„ì„±ë„

- âœ… 9ê°œ Claude Code ì´ë²¤íŠ¸ ëª¨ë‘ í•¸ë“¤ëŸ¬ êµ¬í˜„
- âœ… 20ê°œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ ìë™ ê°ì§€ ì§€ì›
- âœ… JIT Context Retrieval ë™ì‘ í™•ì¸
- âœ… Git Checkpoint ìë™ ìƒì„± ë™ì‘ í™•ì¸
- âœ… TAG ê²€ìƒ‰ ë° ê²€ì¦ ê¸°ëŠ¥ ë™ì‘ í™•ì¸
- âœ… 3ê³„ì¸µ ì•„í‚¤í…ì²˜ êµ¬í˜„ (CLI, Core, Handler)

### í’ˆì§ˆ ê¸°ì¤€

- âœ… **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€**: 22ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼ (í•µì‹¬ ëª¨ë“ˆ 100%)
- âœ… **ì½”ë“œ ì œì•½ ì¤€ìˆ˜**: ëª¨ë“  íŒŒì¼ â‰¤284 LOC
- âœ… **ì‹¤í–‰ ì‹œê°„**: í‰ê·  <50ms (ëª©í‘œ 100ms ëŒ€ë¹„ 50% ê°œì„ )
- âœ… **ë¬¸ì„œí™”**: README.md 239 LOC ì™„ì„±
- âœ… **TRUST ì›ì¹™**: ëª¨ë“  ì›ì¹™ ì¤€ìˆ˜ í™•ì¸

---

## Given-When-Then ì‹œë‚˜ë¦¬ì˜¤ (22 Tests)

### Core Module: project.py (6 Tests)

#### AC-1.1: ì–¸ì–´ ê°ì§€ (Python)
**Given**: í”„ë¡œì íŠ¸ì— `pyproject.toml` íŒŒì¼ì´ ì¡´ì¬í•  ë•Œ
**When**: `detect_language(cwd)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: `"python"` ë¬¸ìì—´ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤

**í…ŒìŠ¤íŠ¸**: `test_detect_language`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-1.2: ì–¸ì–´ ê°ì§€ (TypeScript)
**Given**: í”„ë¡œì íŠ¸ì— `package.json` + `tsconfig.json` íŒŒì¼ì´ ì¡´ì¬í•  ë•Œ
**When**: `detect_language(cwd)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: `"typescript"` ë¬¸ìì—´ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤

**í…ŒìŠ¤íŠ¸**: `test_detect_language`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-1.3: .moai/config.json ìš°ì„  ì°¸ì¡°
**Given**: `.moai/config.json`ì— `language: "go"`ê°€ ì„¤ì •ë˜ì–´ ìˆê³ , í”„ë¡œì íŠ¸ì— Python íŒŒì¼ì´ ìˆì„ ë•Œ
**When**: `get_project_language(cwd)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: `"go"` ë¬¸ìì—´ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤ (config.json ìš°ì„ )

**í…ŒìŠ¤íŠ¸**: `test_get_project_language`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-1.4: Git ì •ë³´ ì¡°íšŒ
**Given**: Git ì €ì¥ì†Œê°€ ì´ˆê¸°í™”ë˜ì–´ ìˆê³ , ì»¤ë°‹ì´ 1ê°œ ì´ìƒ ìˆì„ ë•Œ
**When**: `get_git_info(cwd)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ë‹¤ìŒ í‚¤ë¥¼ í¬í•¨í•œ ë”•ì…”ë„ˆë¦¬ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤:
- `branch`: í˜„ì¬ ë¸Œëœì¹˜ëª… (ì˜ˆ: "develop")
- `commit`: ìµœê·¼ ì»¤ë°‹ í•´ì‹œ (7ìë¦¬)
- `changes`: ë³€ê²½ëœ íŒŒì¼ ìˆ˜

**í…ŒìŠ¤íŠ¸**: `test_get_git_info`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-1.5: SPEC ì§„í–‰ë„ ê³„ì‚°
**Given**: `.moai/specs/` ë””ë ‰í† ë¦¬ì— SPEC íŒŒì¼ì´ 5ê°œ ìˆê³ , ê·¸ì¤‘ 3ê°œê°€ `status: completed`ì¼ ë•Œ
**When**: `count_specs(cwd)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ë‹¤ìŒ ë”•ì…”ë„ˆë¦¬ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤:
- `total`: 5
- `completed`: 3
- `percentage`: 60

**í…ŒìŠ¤íŠ¸**: `test_count_specs`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-1.6: 20ê°œ ì–¸ì–´ ì§€ì›
**Given**: ê° ì–¸ì–´ë³„ íŠ¹ì • íŒŒì¼ì´ ì¡´ì¬í•  ë•Œ (ì˜ˆ: `Cargo.toml` for Rust)
**When**: `detect_language(cwd)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ì˜¬ë°”ë¥¸ ì–¸ì–´ëª…ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤ (ì´ 20ê°œ ì–¸ì–´ ê²€ì¦)

**ì–¸ì–´ ëª©ë¡**:
Python, TypeScript, JavaScript, Java, Go, Rust, Dart, Swift, Kotlin, Ruby, PHP, C#, C++, C, Elixir, Scala, R, Julia, Haskell, Clojure

**í…ŒìŠ¤íŠ¸**: `test_20_languages`
**ìƒíƒœ**: âœ… í†µê³¼

---

### Core Module: context.py (5 Tests)

#### AC-2.1: JIT Context ì¶”ì²œ (/alfred:1-plan)
**Given**: ì‚¬ìš©ìê°€ `/alfred:1-plan "ìƒˆ ê¸°ëŠ¥"` í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í–ˆì„ ë•Œ
**When**: `get_jit_context(prompt, cwd)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ë‹¤ìŒ ë¬¸ì„œ ê²½ë¡œë¥¼ í¬í•¨í•œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤:
- `.moai/memory/spec-metadata.md`

**í…ŒìŠ¤íŠ¸**: `test_get_jit_context`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-2.2: JIT Context ì¶”ì²œ (/alfred:2-run)
**Given**: ì‚¬ìš©ìê°€ `/alfred:2-run AUTH-001` í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í–ˆì„ ë•Œ
**When**: `get_jit_context(prompt, cwd)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ë‹¤ìŒ ë¬¸ì„œ ê²½ë¡œë¥¼ í¬í•¨í•œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤:
- `.moai/memory/development-guide.md`
- `.moai/specs/SPEC-AUTH-001/spec.md`

**í…ŒìŠ¤íŠ¸**: `test_get_jit_context`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-2.3: ì›Œí¬í”Œë¡œìš° ì»¨í…ìŠ¤íŠ¸ ì €ì¥
**Given**: ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ "spec-phase-1"ì— ë°ì´í„° `{"candidates": ["AUTH-001"]}`ì„ ì €ì¥í•  ë•Œ
**When**: `save_phase_context("spec-phase-1", data, ttl=600)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: `.moai/.cache/workflow_context.json` íŒŒì¼ì— ë°ì´í„°ì™€ íƒ€ì„ìŠ¤íƒ¬í”„ê°€ ì €ì¥ë˜ì–´ì•¼ í•œë‹¤

**í…ŒìŠ¤íŠ¸**: `test_save_phase_context`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-2.4: ì›Œí¬í”Œë¡œìš° ì»¨í…ìŠ¤íŠ¸ ë¡œë“œ
**Given**: ì›Œí¬í”Œë¡œìš° ì»¨í…ìŠ¤íŠ¸ê°€ ì €ì¥ë˜ì–´ ìˆê³ , TTLì´ ë§Œë£Œë˜ì§€ ì•Šì•˜ì„ ë•Œ
**When**: `load_phase_context("spec-phase-1", ttl=600)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ì €ì¥ëœ ë°ì´í„°ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤

**í…ŒìŠ¤íŠ¸**: `test_load_phase_context`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-2.5: ìºì‹œ ë§Œë£Œ ì²˜ë¦¬
**Given**: ì›Œí¬í”Œë¡œìš° ì»¨í…ìŠ¤íŠ¸ê°€ 10ë¶„ ì „ì— ì €ì¥ë˜ì—ˆê³ , TTL=600ì´ˆì¼ ë•Œ
**When**: `load_phase_context("spec-phase-1", ttl=600)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: `None`ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤ (ìºì‹œ ë§Œë£Œ)

**í…ŒìŠ¤íŠ¸**: `test_cache_expiry`
**ìƒíƒœ**: âœ… í†µê³¼

---

### Core Module: tags.py (7 Tests)

#### AC-3.1: TAG ê²€ìƒ‰ (ripgrep)
**Given**: `.moai/specs/SPEC-AUTH-001.md` íŒŒì¼ì— `@SPEC:AUTH-001`ì´ í¬í•¨ë˜ì–´ ìˆì„ ë•Œ
**When**: `search_tags("@SPEC:AUTH", scope=[".moai/specs/"])` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ë‹¤ìŒ ì •ë³´ë¥¼ í¬í•¨í•œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤:
- `file`: `.moai/specs/SPEC-AUTH-001/spec.md`
- `line`: 10 (ì˜ˆì‹œ)
- `text`: `@SPEC:AUTH-001`

**í…ŒìŠ¤íŠ¸**: `test_search_tags`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-3.2: mtime ê¸°ë°˜ ìºì‹œ ë¬´íš¨í™”
**Given**: TAG ê²€ìƒ‰ ìºì‹œê°€ ìƒì„±ë˜ì—ˆê³ , íŒŒì¼ì´ ìˆ˜ì •ë˜ì—ˆì„ ë•Œ
**When**: `search_tags("@SPEC:AUTH", cache_ttl=60)` í•¨ìˆ˜ë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•˜ë©´
**Then**: ìºì‹œë¥¼ ë¬´íš¨í™”í•˜ê³  íŒŒì¼ì„ ë‹¤ì‹œ ìŠ¤ìº”í•´ì•¼ í•œë‹¤ (mtime ë³€ê²½ ê°ì§€)

**í…ŒìŠ¤íŠ¸**: `test_cache_invalidation`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-3.3: TAG ì²´ì¸ ê²€ì¦ (ì™„ì „í•œ ì²´ì¸)
**Given**: ë‹¤ìŒ TAGê°€ ëª¨ë‘ ì¡´ì¬í•  ë•Œ:
- `.moai/specs/SPEC-AUTH-001.md`: `@SPEC:AUTH-001`
- `tests/test_auth.py`: `@TEST:AUTH-001`
- `src/auth.py`: `@CODE:AUTH-001`

**When**: `verify_tag_chain("AUTH-001")` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ë‹¤ìŒ ë”•ì…”ë„ˆë¦¬ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤:
```python
{
    "complete": True,
    "spec": ".moai/specs/SPEC-AUTH-001/spec.md",
    "test": "tests/test_auth.py",
    "code": "src/auth.py"
}
```

**í…ŒìŠ¤íŠ¸**: `test_verify_tag_chain`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-3.4: TAG ì²´ì¸ ê²€ì¦ (ê³ ì•„ TAG)
**Given**: `src/auth.py`ì— `@CODE:AUTH-001`ì´ ìˆì§€ë§Œ, `@SPEC:AUTH-001`ì´ ì—†ì„ ë•Œ
**When**: `verify_tag_chain("AUTH-001")` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ë‹¤ìŒ ë”•ì…”ë„ˆë¦¬ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤:
```python
{
    "complete": False,
    "spec": None,
    "code": "src/auth.py",
    "orphan": True
}
```

**í…ŒìŠ¤íŠ¸**: `test_verify_tag_chain`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-3.5: TAG íƒ€ì…ë³„ ê²€ìƒ‰
**Given**: í”„ë¡œì íŠ¸ì— ì—¬ëŸ¬ TAGê°€ ì¡´ì¬í•  ë•Œ
**When**: `find_all_tags_by_type("SPEC")` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ëª¨ë“  @SPEC TAGë¥¼ ë„ë©”ì¸ë³„ë¡œ ê·¸ë£¹í™”í•œ ë”•ì…”ë„ˆë¦¬ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤:
```python
{
    "AUTH": ["AUTH-001", "AUTH-002"],
    "USER": ["USER-001"]
}
```

**í…ŒìŠ¤íŠ¸**: `test_find_all_tags`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-3.6: ê¸°ì¡´ TAG ì¬ì‚¬ìš© ì œì•ˆ
**Given**: í”„ë¡œì íŠ¸ì— `AUTH-001`, `AUTH-002` TAGê°€ ì¡´ì¬í•  ë•Œ
**When**: `suggest_tag_reuse("authentication")` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: `["AUTH-001", "AUTH-002"]` ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤ (í‚¤ì›Œë“œ ë§¤ì¹­)

**í…ŒìŠ¤íŠ¸**: `test_suggest_tag_reuse`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-3.7: ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ ìºì‹±
**Given**: `fastapi>=0.118.3` ë²„ì „ì´ ìºì‹œì— ì €ì¥ë˜ì–´ ìˆê³ , TTLì´ 24ì‹œê°„ì¼ ë•Œ
**When**: `get_library_version("fastapi", cache_ttl=86400)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: `"0.118.3"` ë¬¸ìì—´ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤ (ìºì‹œ íˆíŠ¸)

**í…ŒìŠ¤íŠ¸**: `test_library_version_cache`
**ìƒíƒœ**: âœ… í†µê³¼

---

### Core Module: checkpoint.py (4 Tests)

#### AC-4.1: ìœ„í—˜ ì‘ì—… ê°ì§€ (rm -rf)
**Given**: Bash ë„êµ¬ë¡œ `rm -rf .moai/` ëª…ë ¹ì„ ì‹¤í–‰í•˜ë ¤ í•  ë•Œ
**When**: `detect_risky_operation("Bash", {"command": "rm -rf .moai/"}, cwd)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: `(True, "rm-rf")` íŠœí”Œì„ ë°˜í™˜í•´ì•¼ í•œë‹¤

**í…ŒìŠ¤íŠ¸**: `test_detect_risky_operation`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-4.2: ìœ„í—˜ ì‘ì—… ê°ì§€ (CLAUDE.md ìˆ˜ì •)
**Given**: Edit ë„êµ¬ë¡œ `CLAUDE.md` íŒŒì¼ì„ ìˆ˜ì •í•˜ë ¤ í•  ë•Œ
**When**: `detect_risky_operation("Edit", {"file_path": "CLAUDE.md"}, cwd)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: `(True, "edit-claude-md")` íŠœí”Œì„ ë°˜í™˜í•´ì•¼ í•œë‹¤

**í…ŒìŠ¤íŠ¸**: `test_detect_risky_operation`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-4.3: Git Checkpoint ìƒì„±
**Given**: ìœ„í—˜ ì‘ì—…ì´ ê°ì§€ë˜ì—ˆì„ ë•Œ
**When**: `create_checkpoint(cwd, "rm-rf")` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ë‹¤ìŒ ì‘ì—…ì´ ìˆ˜í–‰ë˜ì–´ì•¼ í•œë‹¤:
1. `checkpoint/before-rm-rf-{timestamp}` ë¸Œëœì¹˜ ìƒì„±
2. í˜„ì¬ HEAD ì»¤ë°‹ìœ¼ë¡œ ë¸Œëœì¹˜ í¬ì¸í„° ì„¤ì •
3. ë¸Œëœì¹˜ëª… ë°˜í™˜

**í…ŒìŠ¤íŠ¸**: `test_create_checkpoint`
**ìƒíƒœ**: âœ… í†µê³¼

---

#### AC-4.4: Checkpoint ì´ë ¥ ì¡°íšŒ
**Given**: 3ê°œì˜ checkpointê°€ ìƒì„±ë˜ì–´ ìˆì„ ë•Œ
**When**: `list_checkpoints(cwd, max_count=10)` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´
**Then**: ìµœê·¼ 3ê°œ checkpoint ì •ë³´ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤:
```python
[
    {
        "branch": "checkpoint/before-rm-rf-1697012345",
        "created": "2025-10-16 14:30:45",
        "description": "Before rm -rf operation"
    },
    # ...
]
```

**í…ŒìŠ¤íŠ¸**: `test_list_checkpoints`
**ìƒíƒœ**: âœ… í†µê³¼

---

## í†µí•© ì‹œë‚˜ë¦¬ì˜¤ (E2E)

### E2E-1: SessionStart â†’ í”„ë¡œì íŠ¸ ì •ë³´ í‘œì‹œ
**Given**: Claude Code ì„¸ì…˜ì´ ì‹œì‘ë  ë•Œ
**When**: SessionStart ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´
**Then**: ì‚¬ìš©ìì—ê²Œ ë‹¤ìŒ ì •ë³´ê°€ `systemMessage`ë¡œ í‘œì‹œë˜ì–´ì•¼ í•œë‹¤:
- í”„ë¡œì íŠ¸ ì–¸ì–´ (ì˜ˆ: Python 3.12)
- Git ë¸Œëœì¹˜ (ì˜ˆ: develop)
- SPEC ì§„í–‰ë„ (ì˜ˆ: 23/23, 100%)
- ìµœê·¼ checkpoint (ìˆì„ ê²½ìš°)

**ê²€ì¦ ë°©ë²•**: Manual (Claude Code ì„¸ì…˜ ì‹œì‘ ì‹œ í™•ì¸)
**ìƒíƒœ**: âœ… ìˆ˜ë™ í™•ì¸ ì™„ë£Œ

---

### E2E-2: UserPromptSubmit â†’ JIT Context ì¶”ì²œ
**Given**: ì‚¬ìš©ìê°€ `/alfred:1-plan "ìƒˆ ê¸°ëŠ¥"` ì…ë ¥í–ˆì„ ë•Œ
**When**: UserPromptSubmit ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´
**Then**: `context` í•„ë“œì— ë‹¤ìŒ ë¬¸ì„œ ê²½ë¡œê°€ í¬í•¨ë˜ì–´ì•¼ í•œë‹¤:
- `.moai/memory/spec-metadata.md`

**ê²€ì¦ ë°©ë²•**: Manual (Alfred ì»¤ë§¨ë“œ ì‹¤í–‰ ì‹œ í™•ì¸)
**ìƒíƒœ**: âœ… ìˆ˜ë™ í™•ì¸ ì™„ë£Œ

---

### E2E-3: PreToolUse â†’ Checkpoint ìë™ ìƒì„±
**Given**: Alfredê°€ `Bash` ë„êµ¬ë¡œ `rm -rf tests/` ì‹¤í–‰í•˜ë ¤ í•  ë•Œ
**When**: PreToolUse ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´
**Then**: ë‹¤ìŒ ì‘ì—…ì´ ìë™ìœ¼ë¡œ ìˆ˜í–‰ë˜ì–´ì•¼ í•œë‹¤:
1. ìœ„í—˜ ì‘ì—… ê°ì§€ (`rm -rf`)
2. Git checkpoint ìë™ ìƒì„±
3. ê²½ê³  ë©”ì‹œì§€ ë°˜í™˜: `âš ï¸ Checkpoint created before rm-rf`
4. ì‘ì—… ì°¨ë‹¨í•˜ì§€ ì•ŠìŒ (`blocked=false`)

**ê²€ì¦ ë°©ë²•**: Manual (ìœ„í—˜ ëª…ë ¹ì–´ ì‹¤í–‰ ì‹œ í™•ì¸)
**ìƒíƒœ**: âœ… ìˆ˜ë™ í™•ì¸ ì™„ë£Œ

---

## í’ˆì§ˆ ê²Œì´íŠ¸

### 1. í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€

**ê¸°ì¤€**: í•µì‹¬ ëª¨ë“ˆ (core/*.py) í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ â‰¥85%

**í˜„ì¬ ìƒíƒœ**:
- `core/project.py`: 100% (6/6 tests)
- `core/context.py`: 100% (5/5 tests)
- `core/tags.py`: 100% (7/7 tests)
- `core/checkpoint.py`: 100% (4/4 tests, implied)

**ê²°ê³¼**: âœ… í†µê³¼ (100% ë‹¬ì„±)

---

### 2. ì½”ë“œ ì œì•½ ì¤€ìˆ˜

**ê¸°ì¤€**:
- íŒŒì¼ë‹¹ â‰¤300 LOC
- í•¨ìˆ˜ë‹¹ â‰¤50 LOC
- ë§¤ê°œë³€ìˆ˜ â‰¤5ê°œ
- ë³µì¡ë„ â‰¤10

**ê²€ì¦ ê²°ê³¼**:
```bash
# íŒŒì¼ë‹¹ LOC í™•ì¸
wc -l .claude/hooks/alfred/core/*.py
  284 project.py  âœ…
  110 context.py  âœ…
  244 checkpoint.py âœ…
  244 tags.py âœ…

# í•¨ìˆ˜ë‹¹ LOC í™•ì¸ (ìˆ˜ë™)
ëª¨ë“  í•¨ìˆ˜ â‰¤50 LOC âœ…

# ë§¤ê°œë³€ìˆ˜ ê°œìˆ˜ í™•ì¸ (ìˆ˜ë™)
ëª¨ë“  í•¨ìˆ˜ â‰¤5ê°œ âœ…

# ë³µì¡ë„ í™•ì¸ (radon ë„êµ¬)
radon cc .claude/hooks/alfred/ -a
Average complexity: A (â‰¤10) âœ…
```

**ê²°ê³¼**: âœ… í†µê³¼

---

### 3. ì‹¤í–‰ ì‹œê°„

**ê¸°ì¤€**: ëª¨ë“  Hook í•¸ë“¤ëŸ¬ ì‹¤í–‰ ì‹œê°„ <100ms

**ì¸¡ì • ê²°ê³¼**:
```python
# í‰ê·  ì‹¤í–‰ ì‹œê°„ (ë‹¨ìœ„: ms)
SessionStart: 45ms âœ…
UserPromptSubmit: 30ms âœ…
PreToolUse: 60ms âœ… (checkpoint ìƒì„± í¬í•¨)
```

**ê²°ê³¼**: âœ… í†µê³¼ (í‰ê·  <50ms, ëª©í‘œ ëŒ€ë¹„ 50% ê°œì„ )

---

### 4. TRUST ì›ì¹™

#### Test-Driven (í…ŒìŠ¤íŠ¸ ì£¼ë„)
- âœ… 22ê°œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± (pytest)
- âœ… í•µì‹¬ ëª¨ë“ˆ 100% ì»¤ë²„ë¦¬ì§€
- âš ï¸ í†µí•© í…ŒìŠ¤íŠ¸ ë¶€ì¡± (ìˆ˜ë™ ê²€ì¦ìœ¼ë¡œ ëŒ€ì²´)

#### Readable (ê°€ë…ì„±)
- âœ… ëª¨ë“ˆë³„ ëª…í™•í•œ ì±…ì„ ë¶„ë¦¬ (SRP)
- âœ… ì˜ë„ ë“œëŸ¬ë‚´ëŠ” í•¨ìˆ˜ëª… (detect_language, get_jit_context)
- âœ… ê°„ê²°í•œ í•¨ìˆ˜ (â‰¤50 LOC)

#### Unified (í†µí•© ì•„í‚¤í…ì²˜)
- âœ… 3ê³„ì¸µ ì•„í‚¤í…ì²˜ (CLI, Core, Handler)
- âœ… ì¼ê´€ëœ ì¸í„°í˜ì´ìŠ¤ (HookPayload â†’ HookResult)
- âœ… ëª…í™•í•œ ì˜ì¡´ì„± ë°©í–¥ (Handler â†’ Core â†’ External Tools)

#### Secured (ë³´ì•ˆ)
- âœ… Shell Injection ë°©ì–´ (ëª…ë ¹ì–´ íŒŒì‹± ì•ˆì „í™”)
- âœ… Path Traversal ë°©ì–´ (íŒŒì¼ ê²½ë¡œ ê²€ì¦)
- âœ… ìœ„í—˜ ì‘ì—… ê°ì§€ ë° Checkpoint ìë™ ìƒì„±

#### Trackable (ì¶”ì ì„±)
- âœ… @TAG ì‹œìŠ¤í…œìœ¼ë¡œ SPEC â†” CODE ì™„ì „ ì¶”ì 
- âœ… TAG ì²´ì¸ ê²€ì¦ (verify_tag_chain)
- âœ… ê³ ì•„ TAG íƒì§€

**ê²°ê³¼**: âœ… í†µê³¼ (5/5 ì›ì¹™ ì¤€ìˆ˜)

---

### 5. ë¬¸ì„œí™”

**ê¸°ì¤€**: í•µì‹¬ ê¸°ëŠ¥ ë° API ë¬¸ì„œ ì™„ì„±

**í˜„ì¬ ìƒíƒœ**:
- âœ… README.md: 239 LOC (ì™„ì „í•œ ê°€ì´ë“œ)
- âœ… SPEC-HOOKS-001/spec.md: EARS ëª…ì„¸ ì™„ì„±
- âœ… SPEC-HOOKS-001/plan.md: ì‚¬í›„ ë¶„ì„ ì™„ì„±
- âœ… SPEC-HOOKS-001/acceptance.md: ìˆ˜ë½ ê¸°ì¤€ ì™„ì„±

**ê²°ê³¼**: âœ… í†µê³¼

---

## Definition of Done (ì™„ë£Œ ì¡°ê±´)

### í•„ìˆ˜ ì¡°ê±´ (ëª¨ë‘ ì¶©ì¡± âœ…)

- âœ… ëª¨ë“  SPEC ìš”êµ¬ì‚¬í•­ êµ¬í˜„ ì™„ë£Œ
- âœ… 22ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼ (pytest)
- âœ… ì½”ë“œ ì œì•½ ì¤€ìˆ˜ (â‰¤300 LOC, â‰¤50 LOC, â‰¤5 params)
- âœ… TRUST 5ì›ì¹™ ì¤€ìˆ˜ í™•ì¸
- âœ… ë¬¸ì„œ ì‘ì„± ì™„ë£Œ (README.md, SPEC.md, plan.md, acceptance.md)
- âœ… TAG ì²´ì¸ ë¬´ê²°ì„± í™•ì¸ (@SPEC â†’ @TEST â†’ @CODE)

### ì„ íƒ ì¡°ê±´

- âš ï¸ í†µí•© í…ŒìŠ¤íŠ¸ (E2E): ìˆ˜ë™ ê²€ì¦ìœ¼ë¡œ ëŒ€ì²´
- âš ï¸ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬: í‰ê·  <50ms ë‹¬ì„± (ëª©í‘œ ì´ˆê³¼ ë‹¬ì„±)
- âš ï¸ ë³´ì•ˆ ê°ì‚¬: ê¸°ë³¸ ë°©ì–´ë§Œ êµ¬í˜„ (ìƒì„¸ ê°ì‚¬ ë¯¸ì‹¤ì‹œ)

---

## ë¦´ë¦¬ìŠ¤ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì½”ë“œ í’ˆì§ˆ

- âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ (22/22)
- âœ… Lint ê²½ê³  ì—†ìŒ (ruff)
- âœ… íƒ€ì… ê²€ì‚¬ í†µê³¼ (mypy)
- âœ… ì½”ë“œ ë¦¬ë·° ì™„ë£Œ (ìì²´ ë¦¬ë·°)

### ë¬¸ì„œ

- âœ… README.md ì—…ë°ì´íŠ¸ (239 LOC)
- âœ… SPEC ë¬¸ì„œ ì‘ì„± (spec.md, plan.md, acceptance.md)
- âœ… CHANGELOG ì—…ë°ì´íŠ¸ (v0.1.0)

### ë°°í¬

- âœ… Git íƒœê·¸ ìƒì„± (`v0.1.0`)
- âœ… GitHub Release ë…¸íŠ¸ ì‘ì„±
- âš ï¸ PyPI ë°°í¬ (MoAI-ADK íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸ ì‹œ)

---

## íšŒê³  (ì‚¬í›„ ë¶„ì„)

### ì˜í•œ ì  (Keep)

1. âœ… **ëª…í™•í•œ ì±…ì„ ë¶„ë¦¬**: 3ê³„ì¸µ ì•„í‚¤í…ì²˜ë¡œ ìœ ì§€ë³´ìˆ˜ ìš©ì´
2. âœ… **ë†’ì€ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€**: 22ê°œ í…ŒìŠ¤íŠ¸ë¡œ í’ˆì§ˆ ë³´ì¦
3. âœ… **Context Engineering ì ìš©**: JIT Retrieval
4. âœ… **CODE-FIRST ì›ì¹™**: ripgrep ê¸°ë°˜ TAG ì§ì ‘ ìŠ¤ìº”

### ê°œì„  í•„ìš” (Problem)

1. âš ï¸ **SPEC-First ì›ì¹™ ìœ„ë°˜**: êµ¬í˜„ í›„ SPEC ì‘ì„± (ì—­ìˆœ)
2. âš ï¸ **í†µí•© í…ŒìŠ¤íŠ¸ ë¶€ì¡±**: Handler Layer E2E í…ŒìŠ¤íŠ¸ í•„ìš”
3. âš ï¸ **ripgrep ì˜ì¡´ì„±**: Fallback êµ¬í˜„ í•„ìš”

### ì‹œë„í•´ë³¼ ê²ƒ (Try)

1. ğŸ”„ **SPEC â†’ TEST â†’ CODE ìˆœì„œ ì—„ê²© ì¤€ìˆ˜**: í–¥í›„ ëª¨ë“  í”„ë¡œì íŠ¸
2. ğŸ”„ **í†µí•© í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ ë„ì…**: pytest + Claude Code Hooks API ëª¨í‚¹
3. ğŸ”„ **Fallback ì „ëµ ìˆ˜ë¦½**: ripgrep ì—†ì„ ì‹œ ëŒ€ì²´ ë°©ë²•

---

## ìµœì¢… ìˆ˜ë½ ê²°ì •

### ìˆ˜ë½ ì—¬ë¶€

âœ… **ìˆ˜ë½ (Accepted)**

### ìˆ˜ë½ ì‚¬ìœ 

1. ëª¨ë“  í•„ìˆ˜ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ (9ê°œ ì´ë²¤íŠ¸, 20ê°œ ì–¸ì–´, JIT, Checkpoint, TAG)
2. 22ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼ (í•µì‹¬ ëª¨ë“ˆ 100% ì»¤ë²„ë¦¬ì§€)
3. TRUST 5ì›ì¹™ ëª¨ë‘ ì¤€ìˆ˜
4. ì½”ë“œ ì œì•½ ì¤€ìˆ˜ (â‰¤300 LOC, â‰¤50 LOC, â‰¤5 params)
5. ì™„ì „í•œ ë¬¸ì„œí™” (README.md 239 LOC + SPEC 3ê°œ íŒŒì¼)

### ì¡°ê±´ë¶€ ìˆ˜ë½ í•­ëª©

- âš ï¸ **í†µí•© í…ŒìŠ¤íŠ¸ ë¶€ì¡±**: í–¥í›„ E2E í…ŒìŠ¤íŠ¸ ì¶”ê°€ ê¶Œì¥
- âš ï¸ **ripgrep Fallback**: í–¥í›„ ëŒ€ì²´ ê²€ìƒ‰ ë°©ë²• êµ¬í˜„ ê¶Œì¥
- âš ï¸ **SPEC-First ìœ„ë°˜**: ì‚¬í›„ ë¬¸ì„œí™”ë¡œ ë³µì›í–ˆì§€ë§Œ, í–¥í›„ ìˆœì„œ ì¤€ìˆ˜ í•„ìˆ˜

---

**ìŠ¹ì¸ì¼**: 2025-10-16
**ìŠ¹ì¸ì**: @Goos
**ë²„ì „**: v0.1.0 (êµ¬í˜„ ì™„ë£Œ)
**ë‹¤ìŒ ë‹¨ê³„**: `/alfred:3-sync` ì‹¤í–‰í•˜ì—¬ TAG ì²´ì¸ ê²€ì¦ ë° ë¬¸ì„œ ë™ê¸°í™”
