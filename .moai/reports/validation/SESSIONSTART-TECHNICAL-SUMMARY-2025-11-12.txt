Claude Code SessionStart í›… ì‹œìŠ¤í…œ - ê¸°ìˆ  ìš”ì•½
============================================

ì‘ì„±ì¼: 2025-11-12
ëŒ€ìƒ: MoAI-ADK ê°œë°œíŒ€
ìƒíƒœ: ë¶„ì„ ì™„ë£Œ, êµ¬í˜„ ê°€ì´ë“œ ì œê³µ

## í•µì‹¬ ë°œê²¬

### í˜„ì¬ ìƒí™©
âœ“ Claude Code í›… ì‹œìŠ¤í…œ ì •ìƒ êµ¬ì„±
âœ“ .claude/settings.jsonì—ì„œ SessionStart ì´ë²¤íŠ¸ ì •ì˜ ì™„ë£Œ
âœ“ session_start__show_project_info.py êµ¬í˜„ ì™„ë£Œ
âœ“ session_start__config_health_check.py êµ¬í˜„ ì™„ë£Œ
âœ“ .moai/config/config.jsonì— session.suppress_setup_messages í•„ë“œ ì¡´ì¬

âœ— í”Œë˜ê·¸ì™€ ì‹¤ì œ êµ¬í˜„ ê°„ì˜ ì—°ë™ ëˆ„ë½
  - session_start__show_project_info.pyê°€ suppress í”Œë˜ê·¸ë¥¼ ë¬´ì‹œí•¨
  - session_start__config_health_check.pyê°€ suppress í”Œë˜ê·¸ë¥¼ ë¬´ì‹œí•¨
  â†’ í•­ìƒ setup ë©”ì‹œì§€ í‘œì‹œ

### í•´ê²° ë°©ë²•
1. session_start__show_project_info.pyì— should_show_setup_messages() ì¶”ê°€
2. session_start__config_health_check.pyì— should_suppress_setup() ì¶”ê°€
3. ë‘ íŒŒì¼ ëª¨ë‘ config í”Œë˜ê·¸ë¥¼ í™•ì¸í•˜ì—¬ ì¡°ê±´ë¶€ ë©”ì‹œì§€ ìƒì„±

## Claude Code í›… ì•„í‚¤í…ì²˜

### 3ê³„ì¸µ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LAYER 1: .claude/settings.json              â”‚
â”‚ - í›… ì´ë²¤íŠ¸ ì •ì˜ (SessionStart, PreToolUse) â”‚
â”‚ - ì‹¤í–‰í•  Python ìŠ¤í¬ë¦½íŠ¸ ëª…ì‹œ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LAYER 2: .claude/hooks/alfred/*.py          â”‚
â”‚ - ì‹¤ì œ í›… êµ¬í˜„                              â”‚
â”‚ - stdinì—ì„œ JSON í˜ì´ë¡œë“œ ìˆ˜ì‹              â”‚
â”‚ - stdoutìœ¼ë¡œ JSON ì‘ë‹µ ë°˜í™˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LAYER 3: .moai/config/config.json          â”‚
â”‚ - í”„ë¡œì íŠ¸ ì„¤ì •                             â”‚
â”‚ - session.suppress_setup_messages í”Œë˜ê·¸   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í›… ì‹¤í–‰ íë¦„

```
Claude Code SessionStart ì´ë²¤íŠ¸ ë°œìƒ
         â†“
.claude/settings.jsonì˜ hooks.SessionStart[] ë¡œë“œ
         â†“
ìˆœì°¨ ì‹¤í–‰:
  1. session_start__show_project_info.py
  2. session_start__config_health_check.py
         â†“
ê° ìŠ¤í¬ë¦½íŠ¸:
  - .moai/config/config.json ì½ìŒ
  - í•„ìš”í•œ ì •ë³´ ìˆ˜ì§‘
  - JSON ì‘ë‹µ ë°˜í™˜
         â†“
Claude Codeê°€ ì‘ë‹µ ì²˜ë¦¬:
  - systemMessage ì‚¬ìš©ìì—ê²Œ í‘œì‹œ
  - askUserQuestion ìˆìœ¼ë©´ ì‚¬ìš©ìì—ê²Œ ì œì‹œ
  - continue=falseë©´ ë‹¤ìŒ í›… ì¤‘ë‹¨
```

### í›… ì‘ë‹µ í˜•ì‹

```json
{
  "continue": true,                    // ë‹¤ìŒ í›… ê³„ì† ì‹¤í–‰
  "systemMessage": "message text",     // ì‚¬ìš©ìì—ê²Œ í‘œì‹œ
  "askUserQuestion": {...},            // ì„ íƒì‚¬í•­: ì‚¬ìš©ì ì…ë ¥ ìš”ì²­
  "hookSpecificOutput": {...}          // ì„ íƒì‚¬í•­: ì‹œìŠ¤í…œ ë¡œê·¸
}
```

## config.jsonì˜ session ì„¹ì…˜

### í˜„ì¬ êµ¬ì¡°

```json
{
  "session": {
    "suppress_setup_messages": false,
    "setup_messages_suppressed_at": "2025-11-12T00:00:00Z",
    "notes": "suppress_setup_messages: Hide setup completion messages..."
  }
}
```

### í•„ë“œ ì„¤ëª…

**suppress_setup_messages** (boolean)
- true: setup ë©”ì‹œì§€ í‘œì‹œ ì•ˆ í•¨
  - 7ì¼ ì´ˆê³¼ ì‹œ ìë™ìœ¼ë¡œ ë‹¤ì‹œ í‘œì‹œ
  - ì„¤ì • ë¬¸ì œê°€ ìˆìœ¼ë©´ ê²½ê³ ë§Œ í‘œì‹œ
- false: setup ë©”ì‹œì§€ í•­ìƒ í‘œì‹œ

**setup_messages_suppressed_at** (ISO 8601 timestamp)
- suppress ê¸°ëŠ¥ì´ í™œì„±í™”ëœ ì‹œê°„
- 7ì¼ ê²½ê³¼ ê³„ì‚°ì— ì‚¬ìš©
- í˜•ì‹: "2025-11-12T00:00:00Z"

## SessionStart.md ë¬¸ì„œì™€ êµ¬í˜„ì˜ ë¶ˆì¼ì¹˜

### SessionStart.mdì˜ should_show_setup_messages() ë¡œì§

```python
def should_show_setup_messages():
    """
    suppress_setup_messages í”Œë˜ê·¸ í™•ì¸

    ë°˜í™˜:
    - true: ë©”ì‹œì§€ í‘œì‹œ
    - false: ë©”ì‹œì§€ ë¹„í‘œì‹œ

    ë™ì‘:
    1. config íŒŒì¼ì´ ì—†ìœ¼ë©´ â†’ true (ë©”ì‹œì§€ í‘œì‹œ)
    2. project.initializedê°€ falseë©´ â†’ true (ë©”ì‹œì§€ í‘œì‹œ)
    3. suppress_setup_messagesê°€ falseë©´ â†’ true (ë©”ì‹œì§€ í‘œì‹œ)
    4. suppress_setup_messagesê°€ trueë©´:
       - setup_messages_suppressed_at íƒ€ì„ìŠ¤íƒ¬í”„ í™•ì¸
       - 7ì¼ ë¯¸ê²½ê³¼ â†’ false (ë©”ì‹œì§€ ë¹„í‘œì‹œ)
       - 7ì¼ ì´ˆê³¼ â†’ true (ë©”ì‹œì§€ í‘œì‹œ)
    """
```

### í˜„ì¬ êµ¬í˜„ì˜ ë¬¸ì œ

session_start__show_project_info.py:
```python
def main():
    # ... ì •ë³´ ìˆ˜ì§‘ ...
    session_output = format_session_output()  # í•­ìƒ ìƒì„±!
    result = {"continue": True, "systemMessage": session_output}
    print(json.dumps(result))
```

ë¬¸ì œ: format_session_output()ì„ í•­ìƒ í˜¸ì¶œí•˜ì—¬ í•­ìƒ ë©”ì‹œì§€ ìƒì„±

### í•„ìš”í•œ ìˆ˜ì •

```python
def main():
    # í”Œë˜ê·¸ í™•ì¸
    show_messages = should_show_setup_messages()

    # ì¡°ê±´ë¶€ ë©”ì‹œì§€ ìƒì„±
    session_output = format_session_output() if show_messages else ""

    result = {"continue": True, "systemMessage": session_output}
    print(json.dumps(result))
```

## êµ¬í˜„ ë‹¨ê³„ë³„ ìš”êµ¬ì‚¬í•­

### ë‹¨ê³„ 1: should_show_setup_messages() í•¨ìˆ˜ ì¶”ê°€

ìœ„ì¹˜: session_start__show_project_info.py

ê¸°ëŠ¥:
- .moai/config/config.json ì½ìŒ
- session.suppress_setup_messages í™•ì¸
- setup_messages_suppressed_atì˜ 7ì¼ ê²½ê³¼ íŒë‹¨
- boolean ë°˜í™˜

ì—ëŸ¬ ì²˜ë¦¬:
- config ì—†ìŒ â†’ true ë°˜í™˜ (ë©”ì‹œì§€ í‘œì‹œ)
- JSON íŒŒì‹± ì˜¤ë¥˜ â†’ true ë°˜í™˜ (ë©”ì‹œì§€ í‘œì‹œ)
- íƒ€ì„ìŠ¤íƒ¬í”„ í˜•ì‹ ì˜¤ë¥˜ â†’ true ë°˜í™˜ (ë©”ì‹œì§€ í‘œì‹œ)

### ë‹¨ê³„ 2: main() í•¨ìˆ˜ ìˆ˜ì •

ìœ„ì¹˜: session_start__show_project_info.py

ë³€ê²½:
```python
# Before
session_output = format_session_output()

# After
show_messages = should_show_setup_messages()
session_output = format_session_output() if show_messages else ""
```

### ë‹¨ê³„ 3: should_suppress_setup() í•¨ìˆ˜ ì¶”ê°€

ìœ„ì¹˜: session_start__config_health_check.py

ê¸°ëŠ¥:
- session.suppress_setup_messages í™•ì¸
- 7ì¼ ê²½ê³¼ íŒë‹¨
- True = ë©”ì‹œì§€ ì–µì œ, False = ë©”ì‹œì§€ í‘œì‹œ

### ë‹¨ê³„ 4: main() í•¨ìˆ˜ ìˆ˜ì •

ìœ„ì¹˜: session_start__config_health_check.py

ë³€ê²½:
```python
# Before
config_report = generate_config_report()
system_message = f"ğŸ“‹ Configuration Health Check:\n{config_report}"

# After
is_suppressed = should_suppress_setup()
if is_suppressed and not should_update:
    system_message = ""
else:
    config_report = generate_config_report()
    system_message = f"ğŸ“‹ Configuration Health Check:\n{config_report}"
```

## ì„¤ì • ë° í”Œë˜ê·¸ ê´€ë¦¬

### í”Œë˜ê·¸ í™œì„±í™” ë°©ë²•

CLIë¥¼ í†µí•œ ì„¤ì •:
```bash
# ë©”ì‹œì§€ í‘œì‹œí•˜ê¸° (suppress ë¹„í™œì„±í™”)
cat > /tmp/patch.json << 'EOF'
{
  "path": ".moai/config/config.json",
  "op": "replace",
  "value": false
}
EOF
# jq -f /tmp/patch.json < .moai/config/config.json

# ë©”ì‹œì§€ ìˆ¨ê¸°ê¸° (suppress í™œì„±í™”)
jq '.session.suppress_setup_messages = true' .moai/config/config.json > /tmp/config.json
jq '.session.setup_messages_suppressed_at = now | gmtime | strftime("%Y-%m-%dT%H:%M:%SZ")' /tmp/config.json > .moai/config/config.json
```

ì§ì ‘ í¸ì§‘:
```bash
# .moai/config/config.json ì§ì ‘ ìˆ˜ì •
{
  "session": {
    "suppress_setup_messages": true,
    "setup_messages_suppressed_at": "2025-11-12T18:30:00Z"
  }
}
```

### í”Œë˜ê·¸ í™•ì¸ ë°©ë²•

```bash
# í˜„ì¬ ì„¤ì • í™•ì¸
cat .moai/config/config.json | jq '.session'

# suppress ìƒíƒœë§Œ í™•ì¸
cat .moai/config/config.json | jq '.session.suppress_setup_messages'

# íƒ€ì„ìŠ¤íƒí”„ë§Œ í™•ì¸
cat .moai/config/config.json | jq '.session.setup_messages_suppressed_at'
```

## í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì´ˆê¸° í”„ë¡œì íŠ¸ (ë©”ì‹œì§€ í‘œì‹œ)

```
ì„¤ì •:
  suppress_setup_messages: false

ì˜ˆìƒ:
  âœ“ SessionStart ì´ë²¤íŠ¸ ë°œìƒ
  âœ“ session_start__show_project_info.py ì‹¤í–‰
    â†’ should_show_setup_messages() = true
    â†’ "ğŸš€ MoAI-ADK Session Started..." í‘œì‹œ
  âœ“ session_start__config_health_check.py ì‹¤í–‰
    â†’ "ğŸ“‹ Configuration Health Check..." í‘œì‹œ
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: í”„ë¡œì íŠ¸ ì„¤ì • ì™„ë£Œ (ë©”ì‹œì§€ ìˆ¨ê¹€)

```
ì„¤ì •:
  suppress_setup_messages: true
  setup_messages_suppressed_at: "2025-11-12T12:00:00Z" (ë°©ê¸ˆ ì„¤ì •)

ì˜ˆìƒ:
  âœ“ SessionStart ì´ë²¤íŠ¸ ë°œìƒ
  âœ“ session_start__show_project_info.py ì‹¤í–‰
    â†’ should_show_setup_messages() = false (7ì¼ ë¯¸ê²½ê³¼)
    â†’ systemMessage = "" (ë¹„í‘œì‹œ)
  âœ“ session_start__config_health_check.py ì‹¤í–‰
    â†’ should_suppress_setup() = true
    â†’ ì„¤ì • ë¬¸ì œ ì—†ìœ¼ë©´ systemMessage = "" (ë¹„í‘œì‹œ)
    â†’ ì„¤ì • ë¬¸ì œ ìˆìœ¼ë©´ ê²½ê³ ë§Œ í‘œì‹œ
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: 7ì¼ ê²½ê³¼ (ë©”ì‹œì§€ ë‹¤ì‹œ í‘œì‹œ)

```
ì„¤ì •:
  suppress_setup_messages: true
  setup_messages_suppressed_at: "2025-11-05T12:00:00Z" (7ì¼ ì´ìƒ ì „)

ì˜ˆìƒ:
  âœ“ SessionStart ì´ë²¤íŠ¸ ë°œìƒ
  âœ“ session_start__show_project_info.py ì‹¤í–‰
    â†’ should_show_setup_messages() = true (7ì¼ ì´ˆê³¼)
    â†’ "ğŸš€ MoAI-ADK Session Started..." ë‹¤ì‹œ í‘œì‹œ
  âœ“ session_start__config_health_check.py ì‹¤í–‰
    â†’ should_suppress_setup() = false (7ì¼ ì´ˆê³¼)
    â†’ "ğŸ“‹ Configuration Health Check..." ë‹¤ì‹œ í‘œì‹œ
```

## íŒŒì¼ ë³€ê²½ ìš”ì•½

### ìˆ˜ì • íŒŒì¼ 1
íŒŒì¼: .claude/hooks/alfred/session_start__show_project_info.py
ì¶”ê°€: should_show_setup_messages() í•¨ìˆ˜ (~30ì¤„)
ìˆ˜ì •: main() í•¨ìˆ˜ì˜ session_output ìƒì„± ë¡œì§ (1ì¤„)
ë¼ì¸: ì•½ 180ì¤„ â†’ 210ì¤„

### ìˆ˜ì • íŒŒì¼ 2
íŒŒì¼: .claude/hooks/alfred/session_start__config_health_check.py
ì¶”ê°€: should_suppress_setup() í•¨ìˆ˜ (~30ì¤„)
ìˆ˜ì •: main() í•¨ìˆ˜ì˜ ì¡°ê±´ ì²˜ë¦¬ (5ì¤„)
ë¼ì¸: ì•½ 280ì¤„ â†’ 320ì¤„

### ë™ê¸°í™” í•„ìš” íŒŒì¼
- src/moai_adk/templates/.claude/hooks/alfred/session_start__show_project_info.py
- src/moai_adk/templates/.claude/hooks/alfred/session_start__config_health_check.py

## ì˜ˆìƒ íš¨ê³¼

êµ¬í˜„ í›„:

1. í”„ë¡œì íŠ¸ ì´ˆê¸°í™” í›„ ìë™ìœ¼ë¡œ ë©”ì‹œì§€ ìˆ¨ê¹€
   - suppress_setup_messagesë¥¼ trueë¡œ ì„¤ì • ê°€ëŠ¥
   - ë¶ˆí•„ìš”í•œ setup ë©”ì‹œì§€ ì œê±°

2. 7ì¼ë§ˆë‹¤ ìë™ ë¦¬ë§ˆì¸ë”
   - ì„¤ì • ìƒíƒœ ì¬í™•ì¸
   - ìƒˆë¡œìš´ ê¸°ëŠ¥ ì•Œë¦¼

3. ì„¤ì • ì˜¤ë¥˜ë§Œ ì¦‰ì‹œ í‘œì‹œ
   - ì¤‘ìš”í•œ ì´ìŠˆëŠ” ì—¬ì „íˆ í‘œì‹œ
   - ì£¼ì˜ ê¹Šì€ ì‚¬ìš©ì ê²½í—˜

4. config.jsonì˜ í”Œë˜ê·¸ ëª…ë ¹ ë°˜ì˜
   - ì‚¬ìš©ì ì„¤ì • ì¡´ì¤‘
   - ì¼ê´€ëœ ë™ì‘

## ë¬¸ì„œ ì •í™•ì„± ê²€ì¦

SessionStart.md ë¬¸ì„œ:
âœ“ ë¡œì§ ì •í™•í•¨
âœ“ êµ¬í˜„ ê°€ì´ë“œë¡œ ì‚¬ìš© ê°€ëŠ¥
âœ“ should_show_setup_messages() ì˜ì‚¬ ì½”ë“œ ìœ íš¨í•¨

ë¬¸ì œì :
âœ— ì‹¤ì œ êµ¬í˜„ê³¼ ë¶ˆì¼ì¹˜
  - ë¬¸ì„œëŠ” ì •í™•í•˜ì§€ë§Œ ì½”ë“œì— ë°˜ì˜ë˜ì§€ ì•ŠìŒ

í•´ê²°ì±…:
âœ“ ë¬¸ì„œì˜ ë¡œì§ì„ ê·¸ëŒ€ë¡œ Python ì½”ë“œë¡œ êµ¬í˜„
âœ“ ë¬¸ì„œ ìœ ì§€ (ì—…ë°ì´íŠ¸ ë¶ˆí•„ìš”)

## ë§ˆì´ê·¸ë ˆì´ì…˜ ì˜í–¥ë„

### ê¸°ì¡´ ê¸°ëŠ¥ ì˜í–¥
- ì—†ìŒ (ê¸°ì¡´ ë™ì‘ ìœ ì§€, suppress=falseê°€ ê¸°ë³¸ê°’)

### ìƒˆ ê¸°ëŠ¥ ì¶”ê°€
- session.suppress_setup_messages í”Œë˜ê·¸ íš¨ê³¼ ë°˜ì˜
- í”Œë˜ê·¸ê°€ trueì¼ ë•Œë§Œ ìƒˆ ë™ì‘ ë°œìƒ

### í•˜ìœ„ í˜¸í™˜ì„±
- âœ“ ìœ ì§€ë¨
- ê¸°ì¡´ config.jsonì—ì„œ suppress_setup_messagesê°€ ì—†ìœ¼ë©´ falseë¡œ ì·¨ê¸‰
- ê¸°ì¡´ í”„ë¡œì íŠ¸ ìë™ ì ì‘

## ë¡¤ì•„ì›ƒ ê³„íš

1. ë¡œì»¬ êµ¬í˜„ (session_start__*.py ìˆ˜ì •)
2. í…ŒìŠ¤íŠ¸ (3ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦)
3. íŒ¨í‚¤ì§€ í…œí”Œë¦¿ ë™ê¸°í™”
4. Git ì»¤ë°‹
5. ë¬¸ì„œ ê²€ì¦

## ì°¸ê³  ìë£Œ

ë¬¸ì„œ:
- .claude/hooks/SessionStart.md (êµ¬í˜„ ì •ì‚¬ë³¸)
- .moai/reports/validation/SESSIONSTART-HOOK-ANALYSIS-2025-11-12.txt (ë¶„ì„)
- .moai/reports/validation/SESSIONSTART-IMPLEMENTATION-GUIDE-2025-11-12.txt (ìƒì„¸ ê°€ì´ë“œ)

íŒŒì¼:
- .moai/config/config.json (ì„¤ì • íŒŒì¼)
- .claude/settings.json (í›… ì •ì˜)
- .claude/hooks/alfred/session_start__show_project_info.py
- .claude/hooks/alfred/session_start__config_health_check.py

## ë‹¤ìŒ ë‹¨ê³„

1. êµ¬í˜„ ê°€ì´ë“œ ê²€í†  (SESSIONSTART-IMPLEMENTATION-GUIDE-2025-11-12.txt)
2. session_start__show_project_info.py ìˆ˜ì •
3. session_start__config_health_check.py ìˆ˜ì •
4. íŒ¨í‚¤ì§€ í…œí”Œë¦¿ ë™ê¸°í™”
5. í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
6. ì»¤ë°‹ ë° ë°°í¬

êµ¬í˜„ ì˜ˆìƒ ì‹œê°„: 30-45ë¶„
í…ŒìŠ¤íŠ¸ ì˜ˆìƒ ì‹œê°„: 15ë¶„
