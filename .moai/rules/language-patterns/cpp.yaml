# C++ Language Patterns
# Common patterns for Modern C++ (C++20/C++23) development
# Version: 1.0.0
# Last Updated: 2026-01-23

---
language: "cpp"
version: "C++20/C++23"
description: "Common patterns for modern C++ development"

# Language Features
features:
  concepts:
    name: "Concepts and Constraints"
    description: "Template constraints with concepts"
    example: |
      template<typename T>
      concept Arithmetic = std::is_arithmetic_v<T>;

      template<Arithmetic T>
      T add(T a, T b) {
          return a + b;
      }

  ranges:
    name: "Ranges Library"
    description: "Composable range operations"
    example: |
      #include <ranges>
      #include <vector>

      std::vector<int> numbers = {1, 2, 3, 4, 5};
      auto result = numbers
          | std::views::filter([](int n) { return n % 2 == 0; })
          | std::views::transform([](int n) { return n * 2; });

  modules:
    name: "Modules (C++20)"
    description: "Module system for faster compilation"
    example: |
      // math.cppm
      export module math;

      export int add(int a, int b) {
          return a + b;
      }

      // main.cpp
      import math;
      int main() {
          return add(1, 2);
      }

  coroutines:
    name: "Coroutines"
    description: "Async programming with coroutines"
    example: |
      #include <coroutine>

      generator<int> range(int start, int end) {
          for (int i = start; i < end; ++i) {
              co_yield i;
          }
      }

# Memory Management
memory_management:
  smart_pointers:
    description: "RAII with smart pointers"
    example: |
      #include <memory>

      auto ptr = std::make_unique<Resource>();
      auto shared = std::make_shared<Resource>();

      // Prefer make_unique/make_shared over new
      // Use unique_ptr by default, shared_ptr when needed

  optional:
    description: "Optional values instead of null"
    example: |
      #include <optional>

      std::optional<User> find_user(int id) {
          if (auto it = users.find(id); it != users.end()) {
              return it->second;
          }
          return std::nullopt;
      }

# Build System
build_system:
  cmake:
    name: "CMake Modern"
    example: |
      cmake_minimum_required(VERSION 3.25)
      project(MyProject VERSION 1.0.0 LANGUAGES CXX)

      set(CMAKE_CXX_STANDARD 23)
      set(CMAKE_CXX_STANDARD_REQUIRED ON)

      add_executable(myapp main.cpp)
      target_link_libraries(myapp PRIVATE fmt::fmt)

      find_package(GTest REQUIRED)
      enable_testing()
      add_test(NAME unit_tests COMMAND tests)

# Testing Patterns
testing:
  googletest:
    name: "Google Test"
    example: |
      #include <gtest/gtest.h>

      class CalculatorTest : public ::testing::Test {
      protected:
          Calculator calc;
      };

      TEST_F(CalculatorTest, AddPositiveNumbers) {
          EXPECT_EQ(calc.add(2, 3), 5);
      }

      TEST_F(CalculatorTest, AddNegativeNumbers) {
          EXPECT_EQ(calc.add(-2, -3), -5);
      }

# Best Practices
best_practices:
  code_style:
    - "Use clang-format for formatting"
    - "Use clang-tidy for static analysis"
    - "Prefer constexpr over macros"
    - "Use auto for complex types"

  memory:
    - "Prefer smart pointers over raw pointers"
    - "Use RAII for resource management"
    - "Avoid manual new/delete"
    - "Use std::span for array views"

  modern_cpp:
    - "Use concepts for template constraints"
    - "Use ranges for data transformations"
    - "Use structured bindings"
    - "Use std::optional instead of null pointers"
