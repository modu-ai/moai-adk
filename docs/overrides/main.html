{% extends "base.html" %}

{% block extrahead %}
  <!-- Font Loading Strategy for Multilingual Support -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Pretendard for Korean -->
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard-dynamic-subset.css" rel="stylesheet">

  <!-- Google Fonts for multilingual support -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* Neutral Color Palette - Direct Material Theme Override */

    /* Define custom color properties for Material theme */
    :root {
      /* Primary palette colors - exact hex codes from extracted image */
      --md-primary-fg-color: #171612;           /* Ink/Accent (Near-Black) */
      --md-primary-fg-color--light: #373632;     /* Lighter variant */
      --md-primary-fg-color--dark: #000000;      /* Darker variant */
      --md-primary-bg-color: #F2F1ED;           /* Bg Warm Off-White */
      --md-primary-bg-color--light: #F7F6F2;     /* Surface Very Light */

      /* Accent palette colors */
      --md-accent-fg-color: #504F4B;            /* Text Secondary (Graphite) */
      --md-accent-fg-color--transparent: rgba(80, 79, 75, 0.1);

      /* Background colors - exact hex codes */
      --md-bg-color: #F2F1ED;                   /* Bg Warm Off-White */
      --md-bg-color--light: #F7F6F2;            /* Surface Very Light */
      --md-bg-color--dark: #EFEEEA;             /* Muted Surface */

      /* Surface colors */
      --md-surface-color: #F7F6F2;              /* Surface Very Light */
      --md-surface-color--light: #FBFAF8;       /* Even lighter surface */
      --md-surface-color--dark: #EFEEEA;        /* Muted Surface */

      /* Text colors - exact hex codes */
      --md-text-color: #171612;                 /* Ink/Accent (Primary text) */
      --md-text-color--secondary: #504F4B;      /* Text Secondary */
      --md-text-color--disabled: #C9C8C4;       /* Neutral Mid */

      /* Border colors */
      --md-border-color: #D5D4D0;               /* Border Light Gray */
      --md-border-color--light: #E0DFDB;        /* Lighter border */
      --md-border-color--dark: #C9C8C4;         /* Neutral Mid */

      /* Code block colors */
      --md-code-bg-color: #EFEEEA;              /* Muted Surface */
      --md-code-fg-color: #171612;              /* Ink/Accent */
      --md-code-border-color: #D5D4D0;          /* Border Light Gray */

      /* Custom neutral palette variables */
      --bg-primary: #F2F1ED;                    /* Bg Warm Off-White */
      --bg-surface: #F7F6F2;                    /* Surface Very Light */
      --bg-surface-muted: #EFEEEA;              /* Muted Surface */
      --border-light: #D5D4D0;                  /* Border Light Gray */
      --text-primary: #171612;                  /* Ink/Accent */
      --text-secondary: #504F4B;                /* Text Secondary */
      --neutral-mid: #C9C8C4;                   /* Neutral Mid */
      --accent-primary: #171612;                /* Accent */
      --accent-contrast: #F2F1ED;               /* Contrast for accent */
      --selection-bg: #E8E7E3;                  /* Selection background */

      /* Font variables */
      --font-ko-text: 'Pretendard', 'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
      --font-ko-code: 'JetBrains Mono', 'D2Coding', 'Consolas', monospace;
      --font-en-text: 'Inter', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      --font-en-code: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
      --font-ja-text: 'Noto Sans JP', 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif;
      --font-ja-code: 'JetBrains Mono', 'GenEi Gothic K', 'Consolas', monospace;
      --font-zh-text: 'Noto Sans SC', 'PingFang SC', 'Microsoft YaHei', sans-serif;
      --font-zh-code: 'JetBrains Mono', 'Consolas', 'Microsoft YaHei', monospace;

      /* Smooth transitions */
      --transition-fast: 150ms ease-in-out;
      --transition-normal: 250ms ease-in-out;
      --transition-slow: 350ms ease-in-out;

      /* Shadows with neutral colors */
      --shadow-sm: 0 1px 2px 0 rgba(23, 22, 18, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(23, 22, 18, 0.1), 0 2px 4px -1px rgba(23, 22, 18, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(23, 22, 18, 0.1), 0 4px 6px -2px rgba(23, 22, 18, 0.05);
    }

    /* Dark Theme Neutral Colors - Material Theme Override */
    [data-md-color-scheme="slate"] {
      /* Primary palette colors for dark theme */
      --md-primary-fg-color: #F2F1ED;           /* Light variant for dark theme */
      --md-primary-fg-color--light: #FFFFFF;    /* Even lighter variant */
      --md-primary-fg-color--dark: #D0CFCA;     /* Darker variant */
      --md-primary-bg-color: #171612;           /* Dark background */
      --md-primary-bg-color--light: #1A1916;    /* Lighter dark background */

      /* Accent palette colors for dark theme */
      --md-accent-fg-color: #C9C8C4;            /* Light neutral for dark theme */
      --md-accent-fg-color--transparent: rgba(201, 200, 196, 0.1);

      /* Background colors for dark theme */
      --md-bg-color: #12110F;                   /* Dark variant of Bg Warm Off-White */
      --md-bg-color--light: #1A1916;            /* Dark variant of Surface Very Light */
      --md-bg-color--dark: #0A0908;             /* Even darker background */

      /* Surface colors for dark theme */
      --md-surface-color: #1A1916;              /* Dark variant of Surface Very Light */
      --md-surface-color--light: #22211E;       /* Dark variant of Muted Surface */
      --md-surface-color--dark: #0A0908;        /* Dark surface */

      /* Text colors for dark theme */
      --md-text-color: #EEEDE8;                 /* Light variant of Ink/Accent */
      --md-text-color--secondary: #C9C8C4;      /* Light variant of Text Secondary */
      --md-text-color--disabled: #AEADA9;       /* Light variant of Neutral Mid */

      /* Border colors for dark theme */
      --md-border-color: #2E2D29;               /* Dark variant of Border Light Gray */
      --md-border-color--light: #3A3935;        /* Lighter dark border */
      --md-border-color--dark: #22211E;         /* Darker border */

      /* Code block colors for dark theme */
      --md-code-bg-color: #1A1916;              /* Dark code background */
      --md-code-fg-color: #EEEDE8;              /* Light code text */
      --md-code-border-color: #2E2D29;          /* Dark code border */

      /* Custom neutral palette variables for dark theme */
      --bg-primary: #12110F;                    /* Dark variant of Bg Warm Off-White */
      --bg-surface: #1A1916;                    /* Dark variant of Surface Very Light */
      --bg-surface-muted: #22211E;              /* Dark variant of Muted Surface */
      --border-light: #2E2D29;                  /* Dark variant of Border Light Gray */
      --text-primary: #EEEDE8;                  /* Light variant of Ink/Accent */
      --text-secondary: #C9C8C4;                /* Light variant of Text Secondary */
      --neutral-mid: #AEADA9;                   /* Light variant of Neutral Mid */
      --accent-primary: #F2F1ED;                /* Light accent for dark theme */
      --accent-contrast: #171612;               /* Dark contrast for light accent */
      --selection-bg: #3A3935;                  /* Dark selection background */

      /* Adjusted shadows for dark theme */
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.3);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.3);
    }

    /* CRITICAL: Dark theme color overrides */
    [data-md-color-scheme="slate"] body,
    [data-md-color-scheme="slate"] .md-typeset,
    [data-md-color-scheme="slate"] .md-content,
    [data-md-color-scheme="slate"] .md-main__inner {
      background-color: #12110F !important;     /* Dark Bg Warm Off-White */
      color: #EEEDE8 !important;               /* Light variant of Ink/Accent */
    }

    [data-md-color-scheme="slate"] .md-header {
      background-color: #1A1916 !important;     /* Dark Surface Very Light */
      color: #EEEDE8 !important;               /* Light variant of Ink/Accent */
      border-bottom: 1px solid #2E2D29 !important; /* Dark Border Light Gray */
    }

    [data-md-color-scheme="slate"] .md-nav {
      background-color: #1A1916 !important;     /* Dark Surface Very Light */
      color: #EEEDE8 !important;               /* Light variant of Ink/Accent */
    }

    [data-md-color-scheme="slate"] .md-nav__item {
      color: #C9C8C4 !important;               /* Light Text Secondary */
    }

    [data-md-color-scheme="slate"] .md-nav__item--active {
      color: #F2F1ED !important;               /* Light accent for dark theme */
      font-weight: 600 !important;
    }

    /* Font loading optimization - prevent FOUT/FOIT */
    .md-typeset {
      font-display: swap;
    }

    /* Material Icons styling for theme consistency */
    .material-icons {
      font-family: 'Material Icons' !important;
      font-weight: normal;
      font-style: normal;
      font-size: 24px;
      line-height: 1;
      letter-spacing: normal;
      text-transform: none;
      display: inline-block;
      white-space: nowrap;
      word-wrap: normal;
      direction: ltr;
      -webkit-font-feature-settings: 'liga';
      -webkit-font-smoothing: antialiased;
      vertical-align: middle;
      color: var(--accent-primary) !important; /* Use theme accent color */
    }

    /* Dark theme Material Icons */
    [data-md-color-scheme="slate"] .material-icons {
      color: var(--accent-primary) !important; /* Light accent for dark theme */
    }

    /* Apply neutral colors to base elements - HIGHEST SPECIFICITY OVERRIDE */
    html body,
    body.md-base {
      font-family: var(--font-ko-text), system-ui, -apple-system, sans-serif !important;
      background-color: #F2F1ED !important;  /* Bg Warm Off-White */
      color: #171612 !important;           /* Ink/Accent */
      transition: background-color var(--transition-normal), color var(--transition-normal);
    }

    /* Force override with maximum specificity */
    html .md-typeset,
    html .md-content,
    html .md-main__inner,
    html .md-container,
    html [data-md-color-scheme="default"] .md-typeset,
    html [data-md-color-scheme="default"] .md-content,
    html [data-md-color-scheme="default"] .md-main__inner {
      background-color: #F2F1ED !important;  /* Bg Warm Off-White */
      color: #171612 !important;           /* Ink/Accent */
      font-style: normal !important;       /* CRITICAL: Force normal font style */
    }

    /* Override header with maximum specificity */
    html .md-header,
    html .md-header__inner,
    html [data-md-color-scheme="default"] .md-header,
    html [data-md-color-scheme="default"] .md-header__inner {
      background-color: #F7F6F2 !important;  /* Surface Very Light */
      color: #171612 !important;           /* Ink/Accent */
      border-bottom: 1px solid #D5D4D0 !important; /* Border Light Gray */
    }

    /* CRITICAL: Force header links to be bold */
    html .md-header a,
    html .md-header__title,
    html .md-header__inner a,
    html [data-md-color-scheme="default"] .md-header a,
    html [data-md-color-scheme="default"] .md-header__title,
    html [data-md-color-scheme="default"] .md-header__inner a {
      font-weight: 700 !important;
      color: var(--text-primary) !important;
      text-decoration: none !important;
    }

    /* Override navigation */
    html .md-nav,
    html .md-nav__inner,
    html .md-nav--primary .md-nav__title,
    html [data-md-color-scheme="default"] .md-nav,
    html [data-md-color-scheme="default"] .md-nav__inner {
      background-color: #F7F6F2 !important;  /* Surface Very Light */
      color: #171612 !important;           /* Ink/Accent */
    }

    html .md-nav__item,
    html .md-nav__link,
    html [data-md-color-scheme="default"] .md-nav__item,
    html [data-md-color-scheme="default"] .md-nav__link {
      color: #504F4B !important;           /* Text Secondary */
    }

    html .md-nav__item--active,
    html .md-nav__link--active,
    html [data-md-color-scheme="default"] .md-nav__item--active,
    html [data-md-color-scheme="default"] .md-nav__link--active {
      color: #171612 !important;           /* Ink/Accent */
      font-weight: 600 !important;
    }

    /* Override sidebar */
    html .md-sidebar,
    html .md-sidebar--secondary,
    html [data-md-color-scheme="default"] .md-sidebar,
    html [data-md-color-scheme="default"] .md-sidebar--secondary {
      background-color: #F7F6F2 !important;  /* Surface Very Light */
    }

    /* Override tabs */
    html .md-tabs,
    html [data-md-color-scheme="default"] .md-tabs {
      background-color: #F7F6F2 !important;  /* Surface Very Light */
      color: #171612 !important;           /* Ink/Accent */
    }

    /* Override footer */
    html .md-footer,
    html [data-md-color-scheme="default"] .md-footer {
      background-color: #EFEEEA !important;  /* Muted Surface */
      color: #504F4B !important;           /* Text Secondary */
      border-top: 1px solid #D5D4D0 !important; /* Border Light Gray */
    }

    /* Override search */
    html .md-search__input,
    html [data-md-color-scheme="default"] .md-search__input {
      background-color: #F7F6F2 !important;  /* Surface Very Light */
      color: #171612 !important;           /* Ink/Accent */
      border: 1px solid #D5D4D0 !important; /* Border Light Gray */
    }

    /* Override buttons */
    html .md-button,
    html [data-md-color-scheme="default"] .md-button {
      background-color: #171612 !important;  /* Ink/Accent */
      color: #F2F1ED !important;           /* Bg Warm Off-White */
    }

    /* Override links */
    html .md-typeset a,
    html [data-md-color-scheme="default"] .md-typeset a {
      color: #171612 !important;           /* Ink/Accent */
    }

    /* CRITICAL: Force color scheme to default and apply palette */
    [data-md-color-scheme="default"] body,
    [data-md-color-scheme="default"] .md-typeset,
    [data-md-color-scheme="default"] .md-content,
    [data-md-color-scheme="default"] .md-main__inner {
      background-color: #F2F1ED !important;  /* Bg Warm Off-White */
      color: #171612 !important;           /* Ink/Accent */
    }

    [data-md-color-scheme="default"] .md-header {
      background-color: #F7F6F2 !important;  /* Surface Very Light */
      color: #171612 !important;           /* Ink/Accent */
      border-bottom: 1px solid #D5D4D0 !important; /* Border Light Gray */
    }

    [data-md-color-scheme="default"] .md-nav {
      background-color: #F7F6F2 !important;  /* Surface Very Light */
      color: #171612 !important;           /* Ink/Accent */
    }

    [data-md-color-scheme="default"] .md-nav__item {
      color: #504F4B !important;           /* Text Secondary */
    }

    [data-md-color-scheme="default"] .md-nav__item--active {
      color: #171612 !important;           /* Ink/Accent */
      font-weight: 600 !important;
    }

    /* Language-specific font adjustments */
    html[lang="ko"] .md-typeset {
      font-family: var(--font-ko-text) !important;
    }

    html[lang="en"] .md-typeset {
      font-family: var(--font-en-text) !important;
    }

    html[lang="ja"] .md-typeset {
      font-family: var(--font-ja-text) !important;
    }

    html[lang="zh"] .md-typeset {
      font-family: var(--font-zh-text) !important;
    }

    /* Code blocks - monospace for all languages with neutral styling */
    .md-typeset code,
    .md-typeset pre {
      font-family: 'JetBrains Mono', 'Consolas', 'Monaco', monospace;
      font-feature-settings: 'liga' 0;
      font-variant-ligatures: none;
      background-color: var(--bg-surface-muted);
      color: var(--text-primary);
      border: 1px solid var(--border-light);
      border-radius: 6px;
      transition: background-color var(--transition-normal), color var(--transition-normal), border-color var(--transition-normal);
    }

    .md-typeset code {
      padding: 0.2em 0.4em;
      font-size: 0.85em;
    }

    .md-typeset pre {
      padding: 1em;
      overflow-x: auto;
      box-shadow: var(--shadow-sm);
    }

    /* Headings - optimized for readability with neutral colors */
    .md-typeset h1,
    .md-typeset h2,
    .md-typeset h3,
    .md-typeset h4,
    .md-typeset h5,
    .md-typeset h6 {
      font-weight: 700 !important;
      letter-spacing: -0.025em;
      line-height: 1.25;
      color: var(--text-primary);
      transition: color var(--transition-normal);
    }

    /* Korean typography improvements - reduce letter spacing for better readability */
    html[lang="ko"] .md-typeset {
      letter-spacing: -0.5px !important;
      font-style: normal !important; /* Ensure no italic styling */
    }

    html[lang="ko"] .md-typeset p,
    html[lang="ko"] .md-typeset li,
    html[lang="ko"] .md-typeset span,
    html[lang="ko"] .md-typeset div {
      letter-spacing: -0.5px !important;
      font-style: normal !important; /* Ensure no italic styling */
    }

    html[lang="ko"] .md-typeset h1,
    html[lang="ko"] .md-typeset h2,
    html[lang="ko"] .md-typeset h3,
    html[lang="ko"] .md-typeset h4,
    html[lang="ko"] .md-typeset h5,
    html[lang="ko"] .md-typeset h6 {
      font-weight: 700 !important;
      letter-spacing: -2px !important;
    }

    html[lang="ko"] .md-typeset code,
    html[lang="ko"] .md-typeset pre {
      letter-spacing: normal !important; /* Keep normal spacing for code */
    }

    /* Links with neutral accent colors */
    .md-typeset a {
      color: var(--accent-primary);
      text-decoration: none;
      transition: color var(--transition-fast), text-decoration var(--transition-fast);
    }

    .md-typeset a:hover {
      color: var(--text-secondary);
      text-decoration: underline;
    }

    /* Text selection with neutral colors */
    ::selection {
      background-color: var(--selection-bg);
      color: var(--text-primary);
    }

    /* Tables with neutral styling */
    .md-typeset table {
      border: 1px solid var(--border-light);
      border-radius: 6px;
      overflow: hidden;
      box-shadow: var(--shadow-sm);
      transition: border-color var(--transition-normal), box-shadow var(--transition-normal);
    }

    .md-typeset table th {
      background-color: var(--bg-surface-muted);
      color: var(--text-primary);
      font-weight: 600;
      border-bottom: 2px solid var(--border-light);
      transition: background-color var(--transition-normal), color var(--transition-normal);
    }

    .md-typeset table td {
      border-bottom: 1px solid var(--border-light);
      color: var(--text-primary);
      transition: border-color var(--transition-normal), color var(--transition-normal);
    }

    .md-typeset table tr:hover {
      background-color: var(--bg-surface);
      transition: background-color var(--transition-fast);
    }

    /* Blockquotes with neutral styling */
    .md-typeset blockquote {
      border-left: 4px solid var(--accent-primary);
      background-color: var(--bg-surface);
      color: var(--text-secondary);
      padding: 1em 1.5em;
      margin: 1em 0;
      border-radius: 0 6px 6px 0;
      box-shadow: var(--shadow-sm);
      transition: background-color var(--transition-normal), color var(--transition-normal), border-color var(--transition-normal);
    }

    /* Admonitions (callouts) with neutral colors */
    .md-typeset .admonition {
      border: 1px solid var(--border-light);
      border-left: 4px solid var(--accent-primary);
      background-color: var(--bg-surface);
      color: var(--text-primary);
      border-radius: 6px;
      box-shadow: var(--shadow-sm);
      transition: background-color var(--transition-normal), color var(--transition-normal), border-color var(--transition-normal);
    }

    .md-typeset .admonition-title {
      color: var(--accent-primary);
      font-weight: 600;
      border-bottom: 1px solid var(--border-light);
      transition: color var(--transition-normal), border-color var(--transition-normal);
    }

    /* Specific admonition types with neutral variations */
    .md-typeset .admonition.note {
      border-left-color: var(--neutral-mid);
    }

    .md-typeset .admonition.note .admonition-title {
      color: var(--text-secondary);
    }

    .md-typeset .admonition.tip {
      border-left-color: var(--accent-primary);
    }

    .md-typeset .admonition.warning {
      border-left-color: #d97706; /* Warm orange for warnings */
    }

    .md-typeset .admonition.danger {
      border-left-color: #dc2626; /* Red for danger */
    }

    /* Buttons with neutral styling */
    .md-button {
      background-color: var(--accent-primary);
      color: var(--accent-contrast);
      border: none;
      border-radius: 6px;
      padding: 0.5em 1em;
      font-weight: 500;
      transition: background-color var(--transition-fast), color var(--transition-fast), transform var(--transition-fast), box-shadow var(--transition-fast);
      box-shadow: var(--shadow-sm);
    }

    .md-button:hover {
      background-color: var(--text-secondary);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .md-button:active {
      transform: translateY(0);
      box-shadow: var(--shadow-sm);
    }

    /* Search input with neutral styling */
    .md-search__input {
      background-color: var(--bg-surface);
      color: var(--text-primary);
      border: 1px solid var(--border-light);
      transition: background-color var(--transition-normal), color var(--transition-normal), border-color var(--transition-normal);
    }

    .md-search__input:focus {
      background-color: var(--bg-surface);
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 2px rgba(23, 22, 18, 0.1);
    }

    /* Navigation with neutral colors */
    .md-nav__item {
      color: var(--text-secondary);
      transition: color var(--transition-normal);
    }

    .md-nav__item:hover {
      color: var(--accent-primary);
    }

    .md-nav__item--active {
      color: var(--accent-primary);
      font-weight: 600;
    }

    /* Header with neutral styling - improved readability */
    .md-header {
      background-color: var(--bg-surface) !important;
      border-bottom: 1px solid var(--border-light) !important;
      box-shadow: var(--shadow-sm) !important;
      transition: background-color var(--transition-normal), border-color var(--transition-normal), box-shadow var(--transition-normal);
      padding: 0.5rem 0;
    }

    /* Header navigation improved styling */
    .md-header__inner {
      font-size: 0.95rem;
      font-weight: 500;
    }

    .md-header__title {
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: -0.025em;
    }

    /* CRITICAL: Navigation links improved - Clear visibility */
    html .md-nav__link,
    html .md-nav__item,
    html [data-md-color-scheme="default"] .md-nav__link,
    html [data-md-color-scheme="default"] .md-nav__item {
      font-size: 0.9rem !important;
      line-height: 1.4 !important;
      padding: 0.5rem 0.75rem !important;
      border-radius: 4px !important;
      transition: all 0.2s ease !important;
      font-weight: 500 !important;
      color: var(--text-primary) !important;
      opacity: 1.0 !important;
    }

    html .md-nav__link:hover,
    html [data-md-color-scheme="default"] .md-nav__link:hover {
      background-color: var(--bg-surface-muted) !important;
      color: var(--accent-primary) !important;
    }

    html .md-nav__item--active,
    html .md-nav__link--active,
    html [data-md-color-scheme="default"] .md-nav__item--active,
    html [data-md-color-scheme="default"] .md-nav__link--active {
      font-weight: 700 !important;
      color: var(--accent-primary) !important;
      background-color: var(--bg-surface-muted) !important;
      opacity: 1.0 !important;
    }

    /* Footer with neutral styling */
    .md-footer {
      background-color: var(--bg-surface-muted);
      color: var(--text-secondary);
      border-top: 1px solid var(--border-light);
      transition: background-color var(--transition-normal), color var(--transition-normal), border-color var(--transition-normal);
    }

    /* Language-specific line height optimization */
    html[lang="ko"] .md-typeset {
      line-height: 1.6;
    }

    html[lang="en"] .md-typeset {
      line-height: 1.5;
    }

    html[lang="ja"] .md-typeset {
      line-height: 1.6;
    }

    html[lang="zh"] .md-typeset {
      line-height: 1.6;
    }

    /* Performance optimization - font-display: swap */
    @font-face {
      font-family: 'Pretendard';
      src: url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard-dynamic-subset.woff2') format('woff2');
      font-display: swap;
    }

    /* Theme toggle animation */
    [data-md-color-scheme] {
      transition: background-color var(--transition-normal), color var(--transition-normal);
    }

    [data-md-color-scheme] * {
      transition: background-color var(--transition-normal), color var(--transition-normal), border-color var(--transition-normal);
    }

    /* Mermaid diagram theme colors - Light Theme */
    .mermaid {
      --mermaid-bg-color: #F7F6F2 !important;            /* Surface Very Light */
      --mermaid-edge-color: #D5D4D0 !important;           /* Border Light Gray */
      --mermaid-node-bg-color: #F2F1ED !important;        /* Bg Warm Off-White */
      --mermaid-node-border-color: #C9C8C4 !important;    /* Neutral Mid */
      --mermaid-primary-color: #171612 !important;        /* Ink/Accent */
      --mermaid-secondary-color: #504F4B !important;      /* Text Secondary */
      --mermaid-tertiary-color: #EFEEEA !important;       /* Muted Surface */
      --mermaid-primary-text-color: #171612 !important;   /* Ink/Accent */
      --mermaid-secondary-text-color: #504F4B !important; /* Text Secondary */
      --mermaid-line-color: #D5D4D0 !important;           /* Border Light Gray */
      --mermaid-section-bkg-color: #F7F6F2 !important;    /* Surface Very Light */
      --mermaid-alt-section-bkg-color: #F2F1ED !important; /* Bg Warm Off-White */
      --mermaid-grid-color: #D5D4D0 !important;           /* Border Light Gray */
      --mermaid-timeline-color: #C9C8C4 !important;      /* Neutral Mid */
      --mermaid-timeline-node-color: #171612 !important;  /* Ink/Accent */
      --mermain-timeline-node-bg-color: #F2F1ED !important; /* Bg Warm Off-White */
    }

    /* Mermaid Dark Theme */
    [data-md-color-scheme="slate"] .mermaid {
      --mermaid-bg-color: #1A1916 !important;            /* Dark Surface Very Light */
      --mermaid-edge-color: #2E2D29 !important;           /* Dark Border Light Gray */
      --mermaid-node-bg-color: #12110F !important;        /* Dark Bg Warm Off-White */
      --mermaid-node-border-color: #3A3935 !important;    /* Dark Neutral Mid */
      --mermaid-primary-color: #EEEDE8 !important;        /* Light Ink/Accent */
      --mermaid-secondary-color: #C9C8C4 !important;      /* Light Text Secondary */
      --mermaid-tertiary-color: #22211E !important;       /* Dark Muted Surface */
      --mermaid-primary-text-color: #EEEDE8 !important;   /* Light Ink/Accent */
      --mermaid-secondary-text-color: #C9C8C4 !important; /* Light Text Secondary */
      --mermaid-line-color: #2E2D29 !important;           /* Dark Border Light Gray */
      --mermaid-section-bkg-color: #1A1916 !important;    /* Dark Surface Very Light */
      --mermaid-alt-section-bkg-color: #12110F !important; /* Dark Bg Warm Off-White */
      --mermaid-grid-color: #2E2D29 !important;           /* Dark Border Light Gray */
      --mermaid-timeline-color: #3A3935 !important;      /* Dark Neutral Mid */
      --mermaid-timeline-node-color: #EEEDE8 !important;  /* Light Ink/Accent */
      --mermain-timeline-node-bg-color: #12110F !important; /* Dark Bg Warm Off-White */
    }

    /* Scrollbar styling for neutral theme */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-surface);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--neutral-mid);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-secondary);
    }

    /* Image styling for design consistency */
    .md-typeset img {
      border-radius: 8px;
      box-shadow: var(--shadow-md);
      transition: transform var(--transition-normal), box-shadow var(--transition-normal);
      max-width: 100%;
      height: auto;
    }

    .md-typeset img:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* Specific styling for Alfred logo */
    .alfred-logo {
      width: 120px;
      height: auto;
      filter: drop-shadow(0 4px 8px rgba(23, 22, 18, 0.1));
      transition: transform var(--transition-normal), filter var(--transition-normal);
    }

    .alfred-logo:hover {
      transform: scale(1.05);
      filter: drop-shadow(0 6px 12px rgba(23, 22, 18, 0.15));
    }

    /* Specific styling for TUI screenshot */
    .tui-screenshot {
      width: 100%;
      max-width: 800px;
      height: auto;
      border-radius: 8px;
      border: 1px solid var(--border-light);
      filter: drop-shadow(0 8px 16px rgba(23, 22, 18, 0.15));
      transition: transform var(--transition-normal), filter var(--transition-normal), border-color var(--transition-normal);
    }

    .tui-screenshot:hover {
      transform: translateY(-4px);
      filter: drop-shadow(0 12px 24px rgba(23, 22, 18, 0.2));
      border-color: var(--neutral-mid);
    }

    /* Dark theme image adjustments */
    [data-md-color-scheme="slate"] .alfred-logo {
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
    }

    [data-md-color-scheme="slate"] .alfred-logo:hover {
      filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.4));
    }

    [data-md-color-scheme="slate"] .tui-screenshot {
      border-color: var(--border-light);
      filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.4));
    }

    [data-md-color-scheme="slate"] .tui-screenshot:hover {
      border-color: var(--neutral-mid);
      filter: drop-shadow(0 12px 24px rgba(0, 0, 0, 0.5));
    }

    /* Responsive image sizing */
    @media (max-width: 768px) {
      .alfred-logo {
        width: 80px;
      }

      .tui-screenshot {
        max-width: 100%;
        border-radius: 6px;
      }
    }

    @media (max-width: 480px) {
      .alfred-logo {
        width: 60px;
      }

      .tui-screenshot {
        border-radius: 4px;
        filter: drop-shadow(0 4px 8px rgba(23, 22, 18, 0.1));
      }

      [data-md-color-scheme="slate"] .tui-screenshot {
        filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
      }
    }

    /* Image container styling */
    .image-container {
      text-align: center;
      margin: 2em 0;
      padding: 1em;
      background-color: var(--bg-surface);
      border-radius: 12px;
      border: 1px solid var(--border-light);
      transition: background-color var(--transition-normal), border-color var(--transition-normal);
    }

    [data-md-color-scheme="slate"] .image-container {
      background-color: var(--bg-surface);
      border-color: var(--border-light);
    }

    /* Image caption styling */
    .image-caption {
      font-size: 0.875em;
      color: var(--text-secondary);
      margin-top: 0.5em;
      font-style: italic;
      letter-spacing: -0.025em;
    }
  </style>
{% endblock %}