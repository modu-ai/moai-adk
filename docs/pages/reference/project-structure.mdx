# 프로젝트 구조

MoAI-ADK 프로젝트는 두 개의 핵심 루트 디렉터리인 `.moai/`와 `.claude/`, 그리고 `CLAUDE.md`로 구성됩니다. Python 패키지 소스(`src/moai_adk`)와 함께 관리하며, Alfred 명령과 CLI 모두 이 구조를 기준으로 동작합니다.

## 최상위 구성

```
.
├── .moai/          # 프로젝트 메타데이터, SPEC, 보고서
├── .claude/        # Alfred 명령어/에이전트/Skills/Hook 템플릿
├── CLAUDE.md       # 세션 가드레일 & 작업 지침
├── src/moai_adk/   # Python 패키지 (CLI, 템플릿 동기화 로직)
└── docs/           # Nextra 기반 온라인 문서 (현재 페이지)
```

## `.moai/` 디렉터리

| 서브폴더 | 내용 | 비고 |
| -------- | ---- | ---- |
| `config.json` | 프로젝트 이름, 언어, 모드, 템플릿 버전 | `/alfred:0-project` & `moai-adk update`에서 갱신 |
| `project/` | `product.md`, `structure.md`, `tech.md` | 프로젝트 개요 & 아키텍처 |
| `specs/` | EARS SPEC 디렉터리 | `/alfred:1-plan` 결과물이 위치 |
| `reports/` | Sync/분석 보고서, TAG 통계 | `/alfred:3-sync`에서 자동 생성 |
| `memory/` | 세션 상태, 사용자 패턴, 언어 정책 | Alfred의 장기 기억 |
| `analysis/`, `metrics/`, `logs/` | 명령/Hook 실행 기록, 성능 데이터 | 품질 추적 및 감사 용도 |
| `backups/`, `.moai-backups/` | 템플릿 백업 | `moai-adk update` 실행 시 생성 |

## `.claude/` 디렉터리

| 서브폴더 | 설명 |
| -------- | ---- |
| `commands/alfred/` | `/alfred:*` 명령어 정의 |
| `agents/alfred/` | 서브 에이전트 지침 |
| `skills/` | Foundation/Essentials/Domain/Language/CC Skills |
| `hooks/alfred/` | Claude Code 이벤트 Hook (Python 스크립트) |
| `output-styles/alfred/` | 보고/학습용 Output Style |
| `settings.json` | Claude Code 세션 설정 (언어, tool policy 등) |
| `settings.local.json` | 커스텀 설정 오버레이 |

## Python 패키지 구조

| 경로 | 역할 |
| ---- | ---- |
| `src/moai_adk/__main__.py` | CLI 엔트리포인트 (`moai-adk` 명령) |
| `src/moai_adk/cli/` | Click 명령 구현 (`init`, `doctor`, `status`, `update`, `backup`) |
| `src/moai_adk/core/` | 템플릿 동기화, 백업, 파일 시스템 유틸 |
| `src/moai_adk/templates/` | `.moai/`, `.claude/` 기본 템플릿 |
| `scripts/check-version-sync.py` | 릴리스 전 버전 일치성 검사 |

## Git 전략

- `.gitignore`는 사용자별 파일(`CLAUDE.md`, `.claude/` 내부 일부) 제외를 기본으로 포함합니다.
- Alfred 명령은 자동으로 feature 브랜치를 생성하고 Draft PR을 준비합니다.
- `/alfred:3-sync` 결과물(보고서, 문서)은 커밋에 포함되어 태그 추적성을 유지합니다.

## 커스터마이징 가이드

- 템플릿을 수정한 경우 `moai-adk update` 실행 전 `.moai-backups/`를 확인하여 병합 전략을 세우세요.
- `.claude/settings.local.json`을 사용하면 공식 템플릿을 수정하지 않고 사용자별 설정을 적용할 수 있습니다.
- 새 자산(명령어, 에이전트, Skill)을 추가할 때는 @TAG를 부여해 `/alfred:3-sync` 보고서와 추적성을 확보하세요.
