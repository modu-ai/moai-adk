# TAG Types Detailed Guide

Syntax, usage, and examples for 4 TAG types.

## 1. SPEC TAG

**Requirement Definition**

### Syntax

```
SPEC-{number}: Description
```

### Location

```
.moai/specs/SPEC-001/
├── spec.md         ← SPEC-001
├── requirements.md
└── tests.md
```

### Example

```markdown
# SPEC-001: User Authentication System

Implements user login, registration, and password management features.
```

### Generation Method

```bash
# Automatically generated by Alfred
/alfred:1-plan "User authentication system"

# Result: SPEC-001 automatically created
```

______________________________________________________________________

## 2. @TEST TAG

**Test Code Identification**

### Syntax

```
@TEST:SPEC-{number}:{test_name}
```

### Location

```
tests/
├── test_auth.py
│   └─ @TEST:SPEC-001:login_success
│   └─ @TEST:SPEC-001:login_failure
│   └─ @TEST:SPEC-001:password_reset
```

### Example

```python
# tests/test_auth.py

# @TEST:SPEC-001:login_success
def test_user_login_with_valid_credentials():
    """User successfully logs in with valid credentials"""
    user = login("user@example.com", "password123")
    assert user.is_authenticated == True

# @TEST:SPEC-001:login_failure
def test_user_login_with_invalid_password():
    """User fails to log in with incorrect password"""
    result = login("user@example.com", "wrong_password")
    assert result.error == "Invalid password"

# @TEST:SPEC-001:password_reset
def test_password_reset():
    """User can reset password"""
    reset_token = request_password_reset("user@example.com")
    assert reset_token is not None
```

### Naming Rules

| Test Type | Example                                           |
| --------- | ------------------------------------------------- |
| Success Cases | @TEST:SPEC-001:success, @TEST:SPEC-001:valid   |
| Error Cases | @TEST:SPEC-001:failure, @TEST:SPEC-001:invalid |
| Edge Cases | @TEST:SPEC-001:empty, @TEST:SPEC-001:boundary  |

______________________________________________________________________

## 3. @CODE TAG

**Implementation Code Identification**

### Syntax

```
@CODE:SPEC-{number}:{feature_name}
```

### Location

```
src/
├── auth.py
│   └─ @CODE:SPEC-001:login
│   └─ @CODE:SPEC-001:register
│   └─ @CODE:SPEC-001:validate_password
```

### Example

```python
# src/auth.py

# @CODE:SPEC-001:login
def login(email: str, password: str) -> User:
    """
    User login

    See @TEST:SPEC-001:login_success
    """
    user = User.query.filter_by(email=email).first()
    if not user or not user.verify_password(password):
        raise AuthenticationError("Invalid credentials")
    return user

# @CODE:SPEC-001:register
def register(email: str, password: str) -> User:
    """
    User registration

    See @TEST:SPEC-001:register_success
    """
    if User.query.filter_by(email=email).first():
        raise ValidationError("Email already registered")

    user = User(email=email)
    user.set_password(password)
    db.session.add(user)
    db.session.commit()
    return user

# @CODE:SPEC-001:validate_password
def validate_password(password: str) -> bool:
    """Password validation"""
    return len(password) >= 8
```

### Detailed TAGs

Large functions can be split with detailed TAGs:

```python
# @CODE:SPEC-001:register
def register(email: str, password: str) -> User:
    # @CODE:SPEC-001:validate_email
    if not is_valid_email(email):
        raise ValidationError("Invalid email")

    # @CODE:SPEC-001:hash_password
    password_hash = hash_password(password)

    # @CODE:SPEC-001:create_user
    user = User(email=email, password_hash=password_hash)

    # @CODE:SPEC-001:save_user
    db.session.add(user)
    db.session.commit()

    return user
```

______________________________________________________________________

## 4. @DOC TAG

**Documentation Identification**

### Syntax

```
@DOC:SPEC-{number}:{document_name}
```

### Location

```
docs/
├── api/
│   └─ auth.md @DOC:SPEC-001:api_documentation
├── deployment/
│   └─ auth-deploy.md @DOC:SPEC-001:deployment_guide
├── migration/
│   └─ 001_create_users.sql @DOC:SPEC-001:database_migration
```

### Example

````markdown
# User Authentication API @DOC:SPEC-001:api_documentation

This document is the API specification for SPEC-001.

## POST /api/auth/login @DOC:SPEC-001:login_endpoint

User login endpoint

**Request**: See @CODE:SPEC-001:login implementation
**Test**: See @TEST:SPEC-001:login_success

### Request Body
```json
{
  "email": "user@example.com",
  "password": "password123"
}
````

### Response

```json
{
  "status": "success",
  "user": {
    "id": 1,
    "email": "user@example.com",
    "name": "User Name"
  }
}
```

## DELETE /api/auth/logout @DOC:SPEC-001:logout_endpoint

User logout

````

---

## TAG Statistics

### Validation Commands

```bash
# TAG statistics for SPEC-001
moai-adk status --spec SPEC-001

# Output example
SPEC-001: User Authentication System
├─ @TEST tags: 5
├─ @CODE tags: 8
├─ @DOC tags: 3
└─ ✅ Completeness: 100%
```

______________________________________________________________________

## TAG Writing Tips

### Good

```python
# @CODE:SPEC-001:validate_email
def validate_email(email):
    pass
```

### Bad

```python
# @CODE:SPEC-001
def validate_email(email):
    pass

# Problem: Function name not included
```

### Good

```python
# @TEST:SPEC-001:email_validation_success
def test_valid_email():
    pass
```

### Bad

```python
# @TEST:SPEC-001:test
def test_valid_email():
    pass

# Problem: Too generic
```

______________________________________________________________________

**Next**: [Traceability System](traceability.md) or [TAG Overview](index.md)



