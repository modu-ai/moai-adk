# æ ¸å¿ƒ Sub-agents è¯¦ç»†æŒ‡å—

Alfred çš„ 10 ä¸ªæ ¸å¿ƒä»£ç†çš„å®Œæ•´å‚è€ƒã€‚

## æ¦‚è§ˆ

| #   | ä»£ç†                   | è§’è‰²           | æŠ€èƒ½æ•° | æœ€ä½³è§„æ¨¡     |
| --- | ---------------------- | -------------- | ------ | ------------ |
| 1   | project-manager        | é¡¹ç›®åˆå§‹åŒ–     | 5ä¸ª    | 1äººå›¢é˜Ÿ      |
| 2   | spec-builder           | SPEC ç¼–å†™      | 8ä¸ª    | æ‰€æœ‰å›¢é˜Ÿ     |
| 3   | implementation-planner | è®¡åˆ’åˆ¶å®š       | 6ä¸ª    | å›¢é˜Ÿé¡¹ç›®     |
| 4   | tdd-implementer        | TDD æ‰§è¡Œ       | 12ä¸ª   | æ‰€æœ‰å›¢é˜Ÿ     |
| 5   | doc-syncer             | æ–‡æ¡£åŒæ­¥       | 8ä¸ª    | æ‰€æœ‰å›¢é˜Ÿ     |
| 6   | tag-agent              | TAG éªŒè¯       | 4ä¸ª    | ä¸­å¤§å‹é¡¹ç›®   |
| 7   | git-manager            | Git è‡ªåŠ¨åŒ–     | 10ä¸ª   | æ‰€æœ‰å›¢é˜Ÿ     |
| 8   | trust-checker          | è´¨é‡éªŒè¯       | 7ä¸ª    | å‘å¸ƒé˜¶æ®µ     |
| 9   | quality-gate           | å‘å¸ƒå‡†å¤‡       | 6ä¸ª    | ç”Ÿäº§ç¯å¢ƒ     |
| 10  | debug-helper           | é”™è¯¯è§£å†³       | 9ä¸ª    | å‡ºç°é—®é¢˜æ—¶   |

______________________________________________________________________

## 1. project-manager

**è§’è‰²**: é¡¹ç›®åˆå§‹åŒ–å’Œå…ƒæ•°æ®ç®¡ç†

### æ¿€æ´»æ¡ä»¶

```
/alfred:0-project [setting|update]
```

### ä¸»è¦èŒè´£

- è®¾ç½®é¡¹ç›®å…ƒæ•°æ® (åç§°ã€æè¿°ã€å›¢é˜Ÿè§„æ¨¡)
- é€‰æ‹©å’Œåº”ç”¨å¯¹è¯è¯­è¨€
- ç¡®å®šå¼€å‘æ¨¡å¼ (solo/team/org)
- åˆå§‹åŒ– `.moai/config.json`
- TRUST 5 åŸåˆ™åŸºæœ¬é…ç½®

### äº¤äº’æ ¼å¼

```
User: /alfred:0-project

Alfred: é¡¹ç›®åç§°?
â†’ project-manager: éªŒè¯å¹¶ä¿å­˜è¾“å…¥å€¼

Alfred: å¼€å‘æ¨¡å¼?
â†’ project-manager: æ ¹æ®å›¢é˜Ÿè§„æ¨¡ç¡®å®šé…ç½®

Alfred: å¯¹è¯è¯­è¨€?
â†’ project-manager: è®¾ç½®æ‰€æœ‰åç»­é€šä¿¡è¯­è¨€

Result: åˆ›å»º .moai/config.json å®Œæˆ
```

### ç”Ÿæˆçš„æ–‡ä»¶ç»“æ„

```
.moai/
â”œâ”€â”€ config.json           # é¡¹ç›®é…ç½®
â”œâ”€â”€ specs/               # SPEC å­˜å‚¨ç›®å½•
â”œâ”€â”€ docs/                # ç”Ÿæˆçš„æ–‡æ¡£
â”œâ”€â”€ reports/             # åˆ†ææŠ¥å‘Š
â””â”€â”€ scripts/             # å®ç”¨å·¥å…·
```

### ä½¿ç”¨åœºæ™¯

- **æ–°é¡¹ç›®å¯åŠ¨**: é¦–æ¬¡ Alfred åˆå§‹åŒ–
- **é…ç½®å˜æ›´**: ä¿®æ”¹è¯­è¨€ã€å›¢é˜Ÿæ¨¡å¼ã€æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡
- **å¤šä¸ªé¡¹ç›®**: æ¯ä¸ªé¡¹ç›®çš„ç‹¬ç«‹é…ç½®

______________________________________________________________________

## 2. spec-builder

**è§’è‰²**: ç¼–å†™ EARS æ ¼å¼çš„ SPEC æ–‡æ¡£

### æ¿€æ´»æ¡ä»¶

```
/alfred:1-plan "æ ‡é¢˜1" "æ ‡é¢˜2" ...
/alfred:1-plan SPEC-ID "ä¿®æ”¹å†…å®¹"
```

### ä¸»è¦èŒè´£

- å°†ç”¨æˆ·éœ€æ±‚ç»“æ„åŒ–ä¸º EARS æ ¼å¼
- è‡ªåŠ¨ç”Ÿæˆ SPEC ID (SPEC-001, SPEC-002...)
- éªŒè¯éœ€æ±‚æ¸…æ™°åº¦
- ç¼–å†™æµ‹è¯•è®¡åˆ’è‰æ¡ˆ
- å®šä¹‰å®ç°èŒƒå›´

### EARS æ ¼å¼ç»“æ„

```
GIVEN:     åˆå§‹æƒ…å†µè¯´æ˜
WHEN:      ç”¨æˆ·æ“ä½œ
THEN:      é¢„æœŸç»“æœ
```

### ç¤ºä¾‹

**ç”¨æˆ·è¾“å…¥**:

```
/alfred:1-plan "ç”¨æˆ·è®¤è¯ç³»ç»Ÿ"
```

**ç”Ÿæˆçš„ SPEC**:

```markdown
# SPEC-001: ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

## éœ€æ±‚

### ç™»å½•åŠŸèƒ½
- GIVEN: ç”¨æˆ·è®¿é—®ç™»å½•é¡µé¢
  WHEN: è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ä»¶å’Œå¯†ç 
  THEN: åˆ›å»ºä¼šè¯å¹¶é‡å®šå‘åˆ°ä»ªè¡¨æ¿

### å¯†ç é”™è¯¯å¤„ç†
- GIVEN: ç™»å½•é¡µé¢
  WHEN: è¾“å…¥é”™è¯¯çš„å¯†ç 
  THEN: æ˜¾ç¤º"å¯†ç é”™è¯¯"æ¶ˆæ¯

## æµ‹è¯•è®¡åˆ’
- [ ] æ­£å¸¸ç™»å½•
- [ ] å¯†ç é”™è¯¯
- [ ] è´¦æˆ·é”å®š (5æ¬¡å¤±è´¥)
```

### è´¨é‡æ ‡å‡†

- æ¸…æ™°çš„éœ€æ±‚ (5ä¸ªä»¥ä¸Š)
- æ— æ­§ä¹‰çš„è¡¨è¾¾
- å¯æµ‹è¯•çš„æ¡ä»¶
- å¯å®ç°çš„èŒƒå›´

______________________________________________________________________

## 3. implementation-planner

**è§’è‰²**: æ¶æ„å’Œæ‰§è¡Œè®¡åˆ’åˆ¶å®š

### æ¿€æ´»æ¡ä»¶

```
/alfred:2-run SPEC-ID (å¼€å§‹æ—¶)
```

### ä¸»è¦èŒè´£

- å°† SPEC åˆ†è§£ä¸ºå®ç°æ­¥éª¤
- è®¾è®¡æ–‡ä»¶å’Œç›®å½•ç»“æ„
- åˆ†æä»»åŠ¡ä¾èµ–å…³ç³»
- è¯†åˆ«å¹¶è¡Œæ‰§è¡Œæœºä¼š
- ä¼°è®¡é¢„æœŸæ—¶é—´å’Œéš¾åº¦

### è®¡åˆ’åˆ¶å®šæµç¨‹

```
SPEC åˆ†æ
    â†“
ä»»åŠ¡åˆ†è§£ (5-10 æ­¥éª¤)
    â†“
ä¾èµ–å…³ç³»æ˜ å°„
    â†“
è¯†åˆ«å¹¶è¡ŒåŒ–æœºä¼š
    â†“
åˆ—å‡ºå—å½±å“çš„æ–‡ä»¶
    â†“
æ—¶é—´ä¼°è®¡
    â†“
è¯·æ±‚ç”¨æˆ·æ‰¹å‡†
```

### è®¡åˆ’æ–‡æ¡£ç¤ºä¾‹

```
SPEC-001: ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

ğŸ“‹ ä»»åŠ¡åˆ†è§£:
1. æ•°æ®æ¨¡å‹è®¾è®¡ (User, Session)
2. æ•°æ®åº“æ¶æ„åˆ›å»º
3. å¯†ç å“ˆå¸Œå‡½æ•°å®ç°
4. ç™»å½•ç«¯ç‚¹å®ç°
5. ä¼šè¯ç®¡ç†ä¸­é—´ä»¶ç¼–å†™
6. é€€å‡ºç™»å½•ç«¯ç‚¹
7. å¯†ç é‡ç½®
8. è´¦æˆ·é”å®šæœºåˆ¶

ğŸ”„ ä¾èµ–å…³ç³»:
1 â†’ 2 â†’ 3 â†’ 4
     â†“
     5 â†’ 6, 7 â†’ 8

âš¡ å¹¶è¡ŒåŒ–:
- 4å’Œ5å¯ä»¥å¹¶è¡Œ
- 6, 7, 8å¯ä»¥å¹¶è¡Œ

ğŸ“ å—å½±å“çš„æ–‡ä»¶:
- models/user.py (NEW)
- models/session.py (NEW)
- api/auth.py (NEW)
- middleware/session.py (NEW)
- tests/test_auth.py (NEW)
- docs/auth.md (NEW)

â±ï¸ é¢„ä¼°æ—¶é—´: 2å°æ—¶ (3é˜¶æ®µ: RED/GREEN/REFACTOR)
```

______________________________________________________________________

## 4. tdd-implementer

**è§’è‰²**: RED-GREEN-REFACTOR å¾ªç¯æ‰§è¡Œ

### æ¿€æ´»æ¡ä»¶

```
/alfred:2-run SPEC-ID (æ‰§è¡Œä¸­)
```

### ä¸»è¦èŒè´£

- RED é˜¶æ®µ: ç¼–å†™å¤±è´¥çš„æµ‹è¯•
- GREEN é˜¶æ®µ: æœ€å°å®ç°
- REFACTOR é˜¶æ®µ: æ”¹è¿›ä»£ç è´¨é‡
- æ¯ä¸ªé˜¶æ®µå®Œæˆåæ›´æ–° TodoWrite
- è·Ÿè¸ªæµ‹è¯•çŠ¶æ€

### TDD ä¸‰é˜¶æ®µå®ç°

#### Phase 1: RED (çº¢è‰²)

```python
# ä»…ç¼–å†™å¤±è´¥çš„æµ‹è¯•
def test_user_registration():
    user = register_user("user@example.com", "password123")
    assert user.email == "user@example.com"
    assert user.is_verified == False

# æ‰§è¡Œ â†’ FAIL âŒ
```

#### Phase 2: GREEN (ç»¿è‰²)

```python
# æœ€å°å®ç°
def register_user(email, password):
    user = User(email=email)
    user.set_password(password)
    db.session.add(user)
    db.session.commit()
    return user

# æ‰§è¡Œ â†’ PASS âœ…
```

#### Phase 3: REFACTOR (é‡æ„)

```python
# æ”¹è¿›ä»£ç è´¨é‡ (ä¿æŒæµ‹è¯•)
def register_user(email, password):
    """ç”¨æˆ·æ³¨å†Œ"""
    # è¾“å…¥éªŒè¯
    if not is_valid_email(email):
        raise ValueError("Invalid email")
    if len(password) < 8:
        raise ValueError("Password too short")

    # æ£€æŸ¥é‡å¤
    if User.query.filter_by(email=email).first():
        raise ValueError("User already exists")

    # åˆ›å»ºç”¨æˆ·
    user = User(email=email)
    user.set_password(password)
    db.session.add(user)
    db.session.commit()

    return user
```

### TodoWrite è·Ÿè¸ª

```
[in_progress] RED: SPEC-001 æµ‹è¯•ç¼–å†™
[completed]   RED: SPEC-001 æµ‹è¯•ç¼–å†™
[in_progress] GREEN: SPEC-001 æœ€å°å®ç°
[completed]   GREEN: SPEC-001 æœ€å°å®ç°
[in_progress] REFACTOR: SPEC-001 ä»£ç æ”¹è¿›
[completed]   REFACTOR: SPEC-001 ä»£ç æ”¹è¿›
```

______________________________________________________________________

## 5. doc-syncer

**è§’è‰²**: æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆå’ŒåŒæ­¥

### æ¿€æ´»æ¡ä»¶

```
/alfred:3-sync auto [SPEC-ID]
```

### ä¸»è¦èŒè´£

- è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ (OpenAPI/Swagger)
- ç”Ÿæˆæ¶æ„å›¾
- ç¼–å†™éƒ¨ç½²æŒ‡å—
- ç”Ÿæˆå˜æ›´æ‘˜è¦æ–‡æ¡£
- éªŒè¯æ–‡æ¡£é“¾æ¥

### ç”Ÿæˆçš„æ–‡æ¡£ç±»å‹

| æ–‡æ¡£         | å†…å®¹                | æ ¼å¼        |
| ------------ | ------------------- | ----------- |
| API Spec     | RESTful ç«¯ç‚¹        | OpenAPI 3.1 |
| Architecture | ç³»ç»Ÿæ¶æ„å›¾          | Mermaid     |
| Deployment   | éƒ¨ç½²æµç¨‹            | Markdown    |
| Changelog    | å˜æ›´å†…å®¹            | Markdown    |
| Migration    | æ•°æ®è¿ç§»            | SQL + è¯´æ˜  |

### ç”Ÿæˆä½ç½®

```
docs/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ SPEC-001.md          # API æ–‡æ¡£
â”œâ”€â”€ architecture/
â”‚   â””â”€â”€ SPEC-001.md          # æ¶æ„
â”œâ”€â”€ deployment/
â”‚   â””â”€â”€ SPEC-001.md          # éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ migrations/
â”‚   â””â”€â”€ 001_create_users.sql # è¿ç§»
â””â”€â”€ changelog/
    â””â”€â”€ v1.0.0.md            # å˜æ›´è®°å½•
```

______________________________________________________________________

## 6. tag-agent

**è§’è‰²**: TAG éªŒè¯å’Œå¯è¿½æº¯æ€§ç®¡ç†

### æ¿€æ´»æ¡ä»¶

```
/alfred:3-sync auto [SPEC-ID]
```

### ä¸»è¦èŒè´£

- éªŒè¯ SPEC â†’ TEST â†’ CODE â†’ DOC TAG é“¾
- æ£€æµ‹å¹¶åˆ é™¤å­¤ç«‹çš„ TAG
- éªŒè¯ TAG å‘½åè§„åˆ™
- ç¡®è®¤å¯è¿½æº¯æ€§å®Œæ•´æ€§

### TAG é“¾

```
SPEC-001 (éœ€æ±‚)
    â†“
@TEST:SPEC-001:* (æµ‹è¯•)
    â†“
@CODE:SPEC-001:* (å®ç°)
    â†“
@DOC:SPEC-001:* (æ–‡æ¡£)
    â†“
ç›¸äº’å¼•ç”¨ (å®Œæ•´çš„å¯è¿½æº¯æ€§)
```

### ç¤ºä¾‹

```python
# @CODE:SPEC-001:register_user
def register_user(email: str, password: str) -> User:
    """ç”¨æˆ·æ³¨å†Œ"""
    # @CODE:SPEC-001:validate_email
    if not is_valid_email(email):
        raise ValueError("Invalid email")

    # @CODE:SPEC-001:hash_password
    hashed = hash_password(password)

    # @CODE:SPEC-001:create_user
    user = User(email=email, password_hash=hashed)
    db.session.add(user)
    db.session.commit()

    return user

# @TEST:SPEC-001:test_register_success
def test_register_success():
    user = register_user("test@example.com", "password123")
    assert user.email == "test@example.com"
```

______________________________________________________________________

## 7. git-manager

**è§’è‰²**: Git å·¥ä½œæµè‡ªåŠ¨åŒ–

### æ¿€æ´»æ¡ä»¶

åœ¨æ‰€æœ‰é˜¶æ®µè‡ªåŠ¨æ¿€æ´»

### ä¸»è¦èŒè´£

- åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (feature/SPEC-001)
- è‡ªåŠ¨ç”Ÿæˆæäº¤æ¶ˆæ¯
- RED/GREEN/REFACTOR é˜¶æ®µæäº¤
- åˆ›å»ºå’Œç®¡ç† PR
- åˆå¹¶å‰éªŒè¯

### Git å·¥ä½œæµ

```
main
    â†“
develop (åŸºç¡€åˆ†æ”¯)
    â†“
feature/SPEC-001 (åŠŸèƒ½åˆ†æ”¯)
    â”‚
    â”œâ”€â”€ feat: RED phase (æäº¤)
    â”œâ”€â”€ feat: GREEN phase (æäº¤)
    â”œâ”€â”€ refactor: code quality (æäº¤)
    â”‚
    â†“
PR #23 (develop â† feature/SPEC-001)
    â”œâ”€â”€ æµ‹è¯•éªŒè¯
    â”œâ”€â”€ ä»£ç å®¡æŸ¥
    â””â”€â”€ åˆå¹¶
    â†“
develop (åˆå¹¶å®Œæˆ)
    â†“
main (å‘å¸ƒæ—¶)
```

### æäº¤æ¶ˆæ¯æ ¼å¼

```
<type>: <description>

ğŸ¤– ä½¿ç”¨ Claude Code ç”Ÿæˆ

Co-Authored-By: ğŸ© Alfred@MoAI
```

**ç±»å‹**:

- `feat`: æ–°åŠŸèƒ½
- `fix`: é”™è¯¯ä¿®å¤
- `refactor`: ä»£ç æ”¹è¿›
- `test`: æ·»åŠ æµ‹è¯•
- `docs`: æ–‡æ¡£æ›´æ–°

______________________________________________________________________

## 8. trust-checker

**è§’è‰²**: TRUST 5 åŸåˆ™éªŒè¯

### æ¿€æ´»æ¡ä»¶

```
/alfred:2-run SPEC-ID (å®Œæˆå)
```

### TRUST 5 åŸåˆ™

| åŸåˆ™           | è¯´æ˜             | éªŒè¯           |
| -------------- | ---------------- | -------------- |
| **T**est First | æµ‹è¯•é©±åŠ¨å¼€å‘     | è¦†ç›–ç‡ 85%+    |
| **R**eadable   | æ˜“è¯»çš„ä»£ç        | Linting é€šè¿‡   |
| **U**nified    | ç»Ÿä¸€çš„ç»“æ„       | éµå®ˆå‘½åè§„åˆ™   |
| **S**ecured    | å®‰å…¨æ€§           | å®‰å…¨æ‰«æé€šè¿‡   |
| **T**rackable  | å¯è¿½æº¯æ€§         | TAG å®Œæ•´æ€§     |

### éªŒè¯ç»“æœ

```
âœ… Test First: 92% è¦†ç›–ç‡ (ç›®æ ‡: 85%)
âœ… Readable: MyPy å®Œæˆ, ruff é€šè¿‡
âœ… Unified: éµå®ˆå‘½åè§„åˆ™
âœ… Secured: ä¾èµ–å®‰å…¨æ£€æŸ¥é€šè¿‡
âœ… Trackable: éªŒè¯ 12 ä¸ª TAG

ğŸ¯ TRUST 5 åˆè§„: PASS âœ…
```

______________________________________________________________________

## 9. quality-gate

**è§’è‰²**: ç¡®è®¤å‘å¸ƒå‡†å¤‡çŠ¶æ€

### æ¿€æ´»æ¡ä»¶

```
/alfred:3-sync auto all (æœ€åé˜¶æ®µ)
```

### éªŒè¯é¡¹ç›®

- âœ… æ‰€æœ‰ SPEC å®Œæˆ
- âœ… æµ‹è¯•è¦†ç›–ç‡ 85% ä»¥ä¸Š
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡
- âœ… å®‰å…¨æ¼æ´ 0 ä¸ª
- âœ… æ–‡æ¡£å®Œæ•´æ€§ 100%
- âœ… TAG å®Œæ•´æ€§

### å‘å¸ƒå†³ç­–

```
æ‰€æœ‰é¡¹ç›®é€šè¿‡ â†’ PR Merge â†’ å¯ä»¥å‘å¸ƒ

å­˜åœ¨å¤±è´¥é¡¹ç›® â†’ è¯¦ç»†æŠ¥å‘Š â†’ éœ€è¦æ”¹è¿›
```

______________________________________________________________________

## 10. debug-helper

**è§’è‰²**: é”™è¯¯åˆ†æå’Œè‡ªåŠ¨ä¿®å¤

### æ¿€æ´»æ¡ä»¶

```
å‘ç”Ÿé”™è¯¯æˆ–å¼‚å¸¸æ—¶è‡ªåŠ¨æ¿€æ´»
```

### ä¸»è¦èŒè´£

- åˆ†æé”™è¯¯å †æ ˆè·Ÿè¸ª
- æ‰¾å‡ºæ ¹æœ¬åŸå› 
- æå‡ºè§£å†³æ–¹æ¡ˆ
- åˆ¤æ–­è‡ªåŠ¨ä¿®å¤çš„å¯èƒ½æ€§
- æå‡ºä¸´æ—¶å˜é€šæ–¹æ¡ˆ

### é”™è¯¯å¤„ç†æµç¨‹

```
å‘ç”Ÿé”™è¯¯
    â†“
debug-helper: åˆ†æ
    â”œâ”€ è¯†åˆ«ç±»å‹
    â”œâ”€ è¿½è¸ªåŸå› 
    â”œâ”€ æœç´¢ç±»ä¼¼æ¡ˆä¾‹
    â””â”€ æå‡ºè§£å†³æ–¹æ¡ˆ
    â†“
[å¯ä»¥è‡ªåŠ¨ä¿®å¤?]
    â”œâ”€ YES â†’ ä¿®å¤å¹¶é‡æ–°æ‰§è¡Œ
    â””â”€ NO â†’ æä¾›è¯¦ç»†æŒ‡å—
```

______________________________________________________________________

## ä»£ç†é—´åä½œæ¡ˆä¾‹

### å®Œæ•´å·¥ä½œæµç¤ºä¾‹

```
SPEC-001 ç¼–å†™ (spec-builder)
    â†“
å®æ–½è®¡åˆ’ (implementation-planner)
    â†“
RED é˜¶æ®µæµ‹è¯• (tdd-implementer)
    â†“
GREEN é˜¶æ®µå®ç° (tdd-implementer)
    â†“
REFACTOR é˜¶æ®µ (tdd-implementer)
    â†“
TRUST 5 éªŒè¯ (trust-checker)
    â†“
Git æäº¤ (git-manager)
    â†“
æ–‡æ¡£ç”Ÿæˆ (doc-syncer)
    â†“
TAG éªŒè¯ (tag-agent)
    â†“
å‘å¸ƒå‡†å¤‡ (quality-gate)
    â†“
å®Œæˆ!
```

______________________________________________________________________

**ä¸‹ä¸€æ­¥**: [ä¸“å®¶ Agents](experts.md) æˆ– [Agents æ¦‚è§ˆ](index.md)
