---
name: moai:2-build
description: êµ¬í˜„í•  SPEC ID (ì˜ˆ: SPEC-001) ë˜ëŠ” allë¡œ ëª¨ë“  SPEC êµ¬í˜„: ì–¸ì–´ë³„ ìµœì í™”ëœ TDD êµ¬í˜„ (Red-Green-Refactor) with SQLite3 tags.db
argument-hint: "SPEC-ID - êµ¬í˜„í•  SPEC ID (ì˜ˆ: SPEC-001) ë˜ëŠ” allë¡œ ëª¨ë“  SPEC êµ¬í˜„"
tools: Read, Write, Edit, MultiEdit, Bash(python3:*), Bash(pytest:*), Bash(npm:*), Bash(node:*), Task, WebFetch, Grep, Glob, TodoWrite
---

# MoAI-ADK 2ë‹¨ê³„: ì–¸ì–´ë³„ ìµœì í™”ëœ TDD êµ¬í˜„ (Red-Green-Refactor)

**TDD êµ¬í˜„ ëŒ€ìƒ**: $ARGUMENTS

## ğŸ” STEP 1: SPEC ë¶„ì„ ë° êµ¬í˜„ ê³„íš ìˆ˜ë¦½

ë¨¼ì € ì§€ì •ëœ SPECì„ ë¶„ì„í•˜ì—¬ êµ¬í˜„ ê³„íšì„ ìˆ˜ë¦½í•˜ê³  ì‚¬ìš©ì í™•ì¸ì„ ë°›ìŠµë‹ˆë‹¤.

### SPEC ë¶„ì„ ì§„í–‰

1. **SPEC ë¬¸ì„œ ë¶„ì„**
   - ìš”êµ¬ì‚¬í•­ ì¶”ì¶œ ë° ë³µì¡ë„ í‰ê°€
   - ê¸°ìˆ ì  ì œì•½ì‚¬í•­ í™•ì¸
   - ì˜ì¡´ì„± ë° ì˜í–¥ ë²”ìœ„ ë¶„ì„

2. **êµ¬í˜„ ì „ëµ ìˆ˜ë¦½**
   - í”„ë¡œì íŠ¸ ì–¸ì–´ ê°ì§€ ë° ìµœì í™”ëœ êµ¬í˜„ ì „ëµ
   - TDD ì ‘ê·¼ ë°©ì‹ ê²°ì • (ì–¸ì–´ë³„ ë„êµ¬ ì„ íƒ)
   - ì˜ˆìƒ ì‘ì—… ë²”ìœ„ ë° ì‹œê°„ ì‚°ì •

3. **êµ¬í˜„ ê³„íš ë³´ê³ **
   - ë‹¨ê³„ë³„ êµ¬í˜„ ê³„íš ì œì‹œ
   - ì ì¬ì  ìœ„í—˜ ìš”ì†Œ ì‹ë³„
   - í’ˆì§ˆ ê²Œì´íŠ¸ ì²´í¬í¬ì¸íŠ¸ ì„¤ì •

### ì‚¬ìš©ì í™•ì¸ ë‹¨ê³„

êµ¬í˜„ ê³„íš ê²€í†  í›„ ë‹¤ìŒ ì¤‘ ì„ íƒí•˜ì„¸ìš”:
- **"ì§„í–‰"** ë˜ëŠ” **"ì‹œì‘"**: ê³„íšëŒ€ë¡œ TDD êµ¬í˜„ ì‹œì‘
- **"ìˆ˜ì • [ë‚´ìš©]"**: ê³„íš ìˆ˜ì • ìš”ì²­
- **"ì¤‘ë‹¨"**: êµ¬í˜„ ì‘ì—… ì¤‘ë‹¨

---

## ğŸš€ STEP 2: TDD êµ¬í˜„ ì‹¤í–‰ (ì‚¬ìš©ì ìŠ¹ì¸ í›„)

ì‚¬ìš©ì ìŠ¹ì¸ í›„ code-builder ì—ì´ì „íŠ¸ê°€ **ì–¸ì–´ë³„ ìµœì í™”**ëœ Red-Green-Refactor ì‚¬ì´í´ê³¼ TRUST ì›ì¹™ ê²€ì¦ì„ ì§€ì›í•©ë‹ˆë‹¤.

## ğŸ”— ì–¸ì–´ë³„ TDD ìµœì í™”

### í”„ë¡œì íŠ¸ ì–¸ì–´ ê°ì§€ ë° ìµœì  ë¼ìš°íŒ…

```python
# ì–¸ì–´ë³„ ìµœì í™”ëœ TDD êµ¬í˜„ ì‹œìŠ¤í…œ
from moai_adk.core.tdd import TDDBuilder
from moai_adk.core.language_detector import detect_project_language
from moai_adk.core.tag_system import TagDatabase

async def execute_optimal_tdd(spec_id: str, spec_content: str) -> TDDResult:
    """í”„ë¡œì íŠ¸ ì–¸ì–´ë¥¼ ê°ì§€í•˜ê³  ìµœì  TDD êµ¬í˜„ì„ ìˆ˜í–‰"""

    # í”„ë¡œì íŠ¸ ì–¸ì–´ ê°ì§€ ë° ìµœì  ë¼ìš°íŒ…
    language = detect_project_language()
    tdd_builder = TDDBuilder(language=language)
    tag_db = TagDatabase()

    # SPEC ë¶„ì„ (ì–¸ì–´ë³„ ìµœì í™”)
    analysis = await tdd_builder.analyze_spec(spec_content)

    # RED-GREEN-REFACTOR ì‚¬ì´í´ (ì–¸ì–´ë³„ ë„êµ¬)
    result = await tdd_builder.execute({
        'spec_id': spec_id,
        'language': language,
        'test_framework': get_optimal_test_framework(language),
        'enable_sqlite_tagging': True
    })

    # tags.db ìë™ ì—…ë°ì´íŠ¸
    await tag_db.update_implementation_tags(spec_id, result.tags)

    return result
}
```

### TDD ë„êµ¬ ë§¤í•‘

| SPEC íƒ€ì… | êµ¬í˜„ ì–¸ì–´ | í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ | ì„±ëŠ¥ ëª©í‘œ | ì»¤ë²„ë¦¬ì§€ ëª©í‘œ |
|-----------|-----------|-------------------|-----------|---------------|
| **CLI/ì‹œìŠ¤í…œ** | TypeScript | Jest + ts-node | < 18ms | 95%+ |
| **API/ë°±ì—”ë“œ** | TypeScript | Jest + SuperTest | < 50ms | 90%+ |
| **í”„ë¡ íŠ¸ì—”ë“œ** | TypeScript | Jest + Testing Library | < 100ms | 85%+ |
| **ë°ì´í„° ì²˜ë¦¬** | TypeScript | Jest + Mock | < 200ms | 85%+ |
| **ì‚¬ìš©ì Python í”„ë¡œì íŠ¸** | Python ì§€ì› | pytest ë„êµ¬ | ì‚¬ìš©ì ì •ì˜ | ì‚¬ìš©ì ì •ì˜ |

## ğŸš€ ìµœì í™”ëœ ì—ì´ì „íŠ¸ í˜‘ì—… êµ¬ì¡°

- **Phase 1**: `code-builder` ì—ì´ì „íŠ¸ê°€ ì „ì²´ TDD ì‚¬ì´í´(Red-Green-Refactor)ì„ ì¼ê´„ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- **Phase 2**: `git-manager` ì—ì´ì „íŠ¸ê°€ TDD ì™„ë£Œ í›„ ëª¨ë“  ì»¤ë°‹ì„ í•œ ë²ˆì— ì²˜ë¦¬í•©ë‹ˆë‹¤.
- **ë‹¨ì¼ ì±…ì„ ì›ì¹™**: code-builderëŠ” ì „ì²´ TDD êµ¬í˜„, git-managerëŠ” Git ì‘ì—… ì¼ê´„ ì²˜ë¦¬
- **ë°°ì¹˜ ì²˜ë¦¬**: ë‹¨ê³„ë³„ ì¤‘ë‹¨ ì—†ì´ ì—°ì†ì ì¸ TDD ì‚¬ì´í´ ì‹¤í–‰
- **ì—ì´ì „íŠ¸ ê°„ í˜¸ì¶œ ê¸ˆì§€**: ê° ì—ì´ì „íŠ¸ëŠ” ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰, ì»¤ë§¨ë“œ ë ˆë²¨ì—ì„œë§Œ ìˆœì°¨ í˜¸ì¶œ

## ğŸ”„ 2ë‹¨ê³„ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ìˆœì„œ

### Phase 1: ë¶„ì„ ë° ê³„íš ë‹¨ê³„

**SPEC ë¶„ì„ê¸°**ê°€ ë‹¤ìŒì„ ìˆ˜í–‰:

1. **SPEC ë¬¸ì„œ ë¡œë”©**: ì§€ì •ëœ SPEC ID ë˜ëŠ” all ëª¨ë“œì— ë”°ë¥¸ ë¬¸ì„œ ë¶„ì„
2. **ë³µì¡ë„ í‰ê°€**: êµ¬í˜„ ë²”ìœ„, ê¸°ìˆ ì  ì œì•½ì‚¬í•­, ì˜ì¡´ì„± ë¶„ì„
3. **ì–¸ì–´ë³„ êµ¬í˜„ ì „ëµ**: í”„ë¡œì íŠ¸ ì–¸ì–´ë³„ ìµœì í™” ë°©ì•ˆ ì œì‹œ
4. **êµ¬í˜„ ê³„íš ìƒì„±**: ë‹¨ê³„ë³„ TDD ì ‘ê·¼ ë°©ì‹ ë° ì˜ˆìƒ ì‘ì—…ëŸ‰ ì‚°ì •
5. **ì‚¬ìš©ì ìŠ¹ì¸ ëŒ€ê¸°**: ê³„íš ê²€í†  ë° í”¼ë“œë°± ìˆ˜ì§‘

### Phase 2: TDD êµ¬í˜„ ë‹¨ê³„ (ìŠ¹ì¸ í›„)

`code-builder` ì—ì´ì „íŠ¸ê°€ ì‚¬ìš©ì ìŠ¹ì¸ í›„ **ì—°ì†ì ìœ¼ë¡œ** ìˆ˜í–‰:

1. **RED**: ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì‘ì„± ë° í™•ì¸
2. **GREEN**: ìµœì†Œ êµ¬í˜„ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ í†µê³¼ í™•ì¸
3. **REFACTOR**: ì½”ë“œ í’ˆì§ˆ ê°œì„  ë° TRUST ì›ì¹™ ê²€ì¦
4. **í’ˆì§ˆ ê²€ì¦**: ë¦°í„°, í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€, ë³´ì•ˆ ê²€ì‚¬ ì¼ê´„ ì‹¤í–‰

### Phase 3: Git ì‘ì—… (git-manager)

`git-manager` ì—ì´ì „íŠ¸ê°€ TDD ì™„ë£Œ í›„ **í•œ ë²ˆì—** ìˆ˜í–‰:

1. **ì²´í¬í¬ì¸íŠ¸ ìƒì„±**: TDD ì‹œì‘ ì „ ë°±ì—… í¬ì¸íŠ¸
2. **êµ¬ì¡°í™”ëœ ì»¤ë°‹**: REDâ†’GREENâ†’REFACTOR ë‹¨ê³„ë³„ ì»¤ë°‹ ìƒì„±
3. **ìµœì¢… ë™ê¸°í™”**: ëª¨ë“œë³„ Git ì „ëµ ì ìš© ë° ì›ê²© ë™ê¸°í™”


## ğŸ“‹ STEP 1 ì‹¤í–‰ ê°€ì´ë“œ: SPEC ë¶„ì„ ë° ê³„íš ìˆ˜ë¦½

### 1. SPEC ë¬¸ì„œ ë¶„ì„

ë‹¤ìŒì„ ìš°ì„ ì ìœ¼ë¡œ ì‹¤í–‰í•˜ì—¬ SPECì„ ë¶„ì„í•©ë‹ˆë‹¤:

```bash
# SPEC ë¬¸ì„œ í™•ì¸ ë° ë¶„ì„
@agent-code-builder --mode=analysis --spec=$ARGUMENTS
```

#### ë¶„ì„ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **ìš”êµ¬ì‚¬í•­ ëª…í™•ì„±**: SPECì˜ ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ì´ êµ¬ì²´ì ì¸ê°€?
- [ ] **ê¸°ìˆ ì  ì œì•½**: ì„±ëŠ¥, í˜¸í™˜ì„±, ë³´ì•ˆ ìš”êµ¬ì‚¬í•­ í™•ì¸
- [ ] **ì˜ì¡´ì„± ë¶„ì„**: ê¸°ì¡´ ì½”ë“œì™€ì˜ ì—°ê²°ì  ë° ì˜í–¥ ë²”ìœ„
- [ ] **ë³µì¡ë„ í‰ê°€**: êµ¬í˜„ ë‚œì´ë„ ë° ì˜ˆìƒ ì‘ì—…ëŸ‰

### 2. êµ¬í˜„ ì „ëµ ê²°ì •

#### TypeScript êµ¬í˜„ ê¸°ì¤€

| SPEC íŠ¹ì„± | êµ¬í˜„ ì–¸ì–´ | ì´ìœ  |
|-----------|-----------|------|
| CLI/ì‹œìŠ¤í…œ ë„êµ¬ | TypeScript | ê³ ì„±ëŠ¥ (18ms), íƒ€ì… ì•ˆì „ì„±, SQLite3 í†µí•© |
| API/ë°±ì—”ë“œ | TypeScript | Node.js ìƒíƒœê³„, Express/Fastify í˜¸í™˜ì„± |
| í”„ë¡ íŠ¸ì—”ë“œ | TypeScript | React/Vue ë„¤ì´í‹°ë¸Œ ì§€ì› |
| ë°ì´í„° ì²˜ë¦¬ | TypeScript | ê³ ì„±ëŠ¥ ë¹„ë™ê¸° ì²˜ë¦¬, íƒ€ì… ì•ˆì „ì„± |
| ì‚¬ìš©ì Python í”„ë¡œì íŠ¸ | Python ë„êµ¬ ì§€ì› | MoAI-ADKê°€ Python í”„ë¡œì íŠ¸ ê°œë°œ ë„êµ¬ ì œê³µ |

#### TDD ì ‘ê·¼ ë°©ì‹

- **Bottom-up**: ìœ í‹¸ë¦¬í‹° â†’ ì„œë¹„ìŠ¤ â†’ API
- **Top-down**: API â†’ ì„œë¹„ìŠ¤ â†’ ìœ í‹¸ë¦¬í‹°
- **Middle-out**: í•µì‹¬ ë¡œì§ â†’ ì–‘ë°©í–¥ í™•ì¥

### 3. êµ¬í˜„ ê³„íš ë³´ê³ ì„œ ìƒì„±

ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ê³„íšì„ ì œì‹œí•©ë‹ˆë‹¤:

```
## êµ¬í˜„ ê³„íš ë³´ê³ ì„œ: [SPEC-ID]

### ğŸ“Š ë¶„ì„ ê²°ê³¼
- **ë³µì¡ë„**: [ë‚®ìŒ/ì¤‘ê°„/ë†’ìŒ]
- **ì˜ˆìƒ ì‘ì—…ì‹œê°„**: [ì‹œê°„ ì‚°ì •]
- **ì£¼ìš” ê¸°ìˆ  ë„ì „**: [ê¸°ìˆ ì  ì–´ë ¤ì›€]

### ğŸ¯ êµ¬í˜„ ì „ëµ
- **ì„ íƒ ì–¸ì–´**: [Python/TypeScript + ì´ìœ ]
- **TDD ì ‘ê·¼ë²•**: [Bottom-up/Top-down/Middle-out]
- **í•µì‹¬ ëª¨ë“ˆ**: [ì£¼ìš” êµ¬í˜„ ëŒ€ìƒ]

### ğŸš¨ ìœ„í—˜ ìš”ì†Œ
- **ê¸°ìˆ ì  ìœ„í—˜**: [ì˜ˆìƒ ë¬¸ì œì ]
- **ì˜ì¡´ì„± ìœ„í—˜**: [ì™¸ë¶€ ì˜ì¡´ì„± ì´ìŠˆ]
- **ì¼ì • ìœ„í—˜**: [ì§€ì—° ê°€ëŠ¥ì„±]

### âœ… í’ˆì§ˆ ê²Œì´íŠ¸
- **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€**: [ëª©í‘œ %]
- **ì„±ëŠ¥ ëª©í‘œ**: [êµ¬ì²´ì  ì§€í‘œ]
- **ë³´ì•ˆ ì²´í¬í¬ì¸íŠ¸**: [ê²€ì¦ í•­ëª©]

---
**ìŠ¹ì¸ ìš”ì²­**: ìœ„ ê³„íšìœ¼ë¡œ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
("ì§„í–‰", "ìˆ˜ì • [ë‚´ìš©]", "ì¤‘ë‹¨" ì¤‘ ì„ íƒ)
```

---

## ğŸš€ STEP 2 ì‹¤í–‰ ê°€ì´ë“œ: TDD êµ¬í˜„ (ìŠ¹ì¸ í›„)

ì‚¬ìš©ìê°€ **"ì§„í–‰"** ë˜ëŠ” **"ì‹œì‘"**ì„ ì„ íƒí•œ ê²½ìš°ì—ë§Œ ë‹¤ìŒì„ ì‹¤í–‰í•©ë‹ˆë‹¤:

```bash
# TDD êµ¬í˜„ ì‹œì‘
@agent-code-builder --mode=implement --spec=$ARGUMENTS --approved=true
```

### TDD ë‹¨ê³„ë³„ ê°€ì´ë“œ

1. **RED**: Given/When/Then êµ¬ì¡°ë¡œ ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸ ì‘ì„±. ì–¸ì–´ë³„ í…ŒìŠ¤íŠ¸ íŒŒì¼ ê·œì¹™ì„ ë”°ë¥´ê³ , ì‹¤íŒ¨ ë¡œê·¸ë¥¼ ê°„ë‹¨íˆ ê¸°ë¡í•©ë‹ˆë‹¤.
2. **GREEN**: í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼ì‹œí‚¤ëŠ” ìµœì†Œí•œì˜ êµ¬í˜„ë§Œ ì¶”ê°€í•©ë‹ˆë‹¤. ìµœì í™”ëŠ” REFACTOR ë‹¨ê³„ë¡œ ë¯¸ë£¹ë‹ˆë‹¤.
3. **REFACTOR**: ì¤‘ë³µ ì œê±°, ëª…ì‹œì  ë„¤ì´ë°, êµ¬ì¡°í™” ë¡œê¹…/ì˜ˆì™¸ ì²˜ë¦¬ ë³´ê°•. í•„ìš” ì‹œ ì¶”ê°€ ì»¤ë°‹ìœ¼ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤.

> í—Œë²• Article Iì€ ê¸°ë³¸ ê¶Œì¥ì¹˜ë§Œ ì œê³µí•˜ë¯€ë¡œ, `simplicity_threshold`ë¥¼ ì´ˆê³¼í•˜ëŠ” êµ¬ì¡°ê°€ í•„ìš”í•˜ë‹¤ë©´ SPEC ë˜ëŠ” ADRì— ê·¼ê±°ë¥¼ ë‚¨ê¸°ê³  ì§„í–‰í•˜ì„¸ìš”.

## ì—ì´ì „íŠ¸ ì—­í•  ë¶„ë¦¬

### code-builder ì „ë‹´ ì˜ì—­

- TDD Red-Green-Refactor ì½”ë“œ êµ¬í˜„
- í…ŒìŠ¤íŠ¸ ì‘ì„± ë° ì‹¤í–‰
- TRUST 5ì›ì¹™ ê²€ì¦
- ì½”ë“œ í’ˆì§ˆ ì²´í¬
- ì–¸ì–´ë³„ ë¦°í„°/í¬ë§¤í„° ì‹¤í–‰

### git-manager ì „ë‹´ ì˜ì—­

- ëª¨ë“  Git ì»¤ë°‹ ì‘ì—… (add, commit, push)
- TDD ë‹¨ê³„ë³„ ì²´í¬í¬ì¸íŠ¸ ìƒì„±
- ëª¨ë“œë³„ ì»¤ë°‹ ì „ëµ ì ìš©
- ê¹ƒ ë¸Œëœì¹˜/íƒœê·¸ ê´€ë¦¬
- ì›ê²© ë™ê¸°í™” ì²˜ë¦¬

## í’ˆì§ˆ ê²Œì´íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

- í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ â‰¥ `.moai/config.json.test_coverage_target` (ê¸°ë³¸ 85%)
- ë¦°í„°/í¬ë§¤í„° í†µê³¼ (`ruff`, `eslint --fix`, `gofmt` ë“±)
- êµ¬ì¡°í™” ë¡œê¹… ë˜ëŠ” ê´€ì¸¡ ë„êµ¬ í˜¸ì¶œ ì¡´ì¬ í™•ì¸
- @TAG ì—…ë°ì´íŠ¸ í•„ìš” ë³€ê²½ ì‚¬í•­ ë©”ëª¨ (ë‹¤ìŒ ë‹¨ê³„ì—ì„œ doc-syncerê°€ ì‚¬ìš©)

## ë‹¤ìŒ ë‹¨ê³„

- TDD êµ¬í˜„ ì™„ë£Œ í›„ `/moai:3-sync`ë¡œ ë¬¸ì„œ ë™ê¸°í™” ì§„í–‰
- ëª¨ë“  Git ì‘ì—…ì€ git-manager ì—ì´ì „íŠ¸ê°€ ì „ë‹´í•˜ì—¬ ì¼ê´€ì„± ë³´ì¥
- ì—ì´ì „íŠ¸ ê°„ ì§ì ‘ í˜¸ì¶œ ì—†ì´ ì»¤ë§¨ë“œ ë ˆë²¨ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ë§Œ ì‚¬ìš©
