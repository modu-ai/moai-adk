---
title: Performance & Security Guide (ì„±ëŠ¥ & ë³´ì•ˆ)
description: MoAI-ADK - ì„±ëŠ¥ ìµœì í™”, ë³´ì•ˆ ê²€ì¦, OWASP Top 10, ëª¨ë‹ˆí„°ë§ ê°€ì´ë“œ
---

# Performance & Security: í”„ë¡œë•ì…˜ ì¤€ë¹„

ì´ ê°€ì´ë“œëŠ” **í”„ë¡œë•ì…˜ ë°°í¬ ì „ í•„ìˆ˜ ì‚¬í•­**ì¸ ì„±ëŠ¥ ìµœì í™”ì™€ ë³´ì•ˆ ê°•í™”ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.

---

## ğŸš€ Part 1: ì„±ëŠ¥ ìµœì í™”

### 1ë‹¨ê³„: ë² ì´ìŠ¤ë¼ì¸ ì¸¡ì •

```bash
$ /alfred:3-sync --measure-performance

Profiler:
  ğŸ“Š CPU Profile
    - login_user: 45ms (20% of request)
    - verify_token: 8ms (3% of request)
    - database_query: 120ms (55% of request) âš ï¸

  ğŸ’¾ Memory Profile
    - Peak memory: 256MB
    - Memory leaks: None detected
    - GC pause: 2.3ms

  ğŸ“ˆ Database Profile
    - Query count: 5 queries per request
    - Slow queries (> 100ms): 1 query
```

### 2ë‹¨ê³„: ë³‘ëª© ì§€ì  ë¶„ì„

```python
# ëŠë¦° ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ìµœì í™”

# âŒ Before (120ms)
def get_user_with_orders(user_id):
    user = User.query.filter_by(id=user_id).first()
    orders = Order.query.filter_by(user_id=user_id).all()  # N+1 ë¬¸ì œ
    
    for order in orders:
        items = OrderItem.query.filter_by(order_id=order.id).all()

# âœ… After (8ms, 15ë°° ë¹¨ë¼ì§)
def get_user_with_orders(user_id):
    user = User.query\
        .options(
            joinedload(User.orders)
            .joinedload(Order.items)
        ).filter_by(id=user_id).first()
```

### 3ë‹¨ê³„: ìºì‹± ì „ëµ

```python
# 1. ì¿¼ë¦¬ ê²°ê³¼ ìºì‹±
from functools import lru_cache

@lru_cache(maxsize=1000)
def get_product(product_id):
    return Product.query.get(product_id)

# 2. Redis ìºì‹±
def get_user_profile(user_id):
    cache_key = f"user:{user_id}"
    
    # ìºì‹œì—ì„œ ë¨¼ì € í™•ì¸
    cached = redis.get(cache_key)
    if cached:
        return json.loads(cached)
    
    # ìºì‹œ ë¯¸ìŠ¤: DBì—ì„œ ì¡°íšŒ
    user = User.query.get(user_id)
    
    # ìºì‹œì— ì €ì¥ (5ë¶„)
    redis.setex(cache_key, 300, json.dumps(user))
    
    return user

# 3. HTTP ìºì‹±
@app.route('/products/<id>')
def get_product(id):
    return {
        "data": product,
        "headers": {
            "Cache-Control": "public, max-age=3600"  # 1ì‹œê°„
        }
    }
```

### 4ë‹¨ê³„: ì„±ëŠ¥ ê²€ì¦

```bash
$ pytest tests/performance/ -v

ğŸƒ Performance Tests:
  âœ… test_get_products < 100ms (actual: 45ms)
  âœ… test_login < 200ms (actual: 120ms)
  âœ… test_cache_hit_rate > 80% (actual: 87%)
  âœ… test_memory_usage < 512MB (actual: 256MB)

ğŸ“Š CI/CD Integration:
  - PRs fail if perf regression > 10%
  - Dashboard shows trend over time
```

---

## ğŸ”’ Part 2: ë³´ì•ˆ ê²€ì¦

### OWASP Top 10 ì²´í¬ë¦¬ìŠ¤íŠ¸

```yaml
A1: Broken Access Control
  âœ… ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ ì¸ì¦ ê²€ì¦
  âœ… ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (RBAC)
  âœ… í† í° ê²€ì¦ (ë§¤ ìš”ì²­ë§ˆë‹¤)

A2: Cryptographic Failures
  âœ… TLS 1.3+ ì‚¬ìš©
  âœ… AES-256-GCM ì•”í˜¸í™”
  âœ… ë¯¼ê°í•œ ë°ì´í„° ì•”í˜¸í™”

A3: Injection
  âœ… SQL Injection ë°©ì§€ (parameterized queries)
  âœ… NoSQL Injection ë°©ì§€
  âœ… Command Injection ë°©ì§€ (subprocess ì‚¬ìš© ì œí•œ)

A4: Insecure Design
  âœ… Threat modeling ì™„ë£Œ
  âœ… Security by design
  âœ… Rate limiting êµ¬í˜„

A5: Security Misconfiguration
  âœ… ê¸°ë³¸ ìê²©ì¦ëª… ë³€ê²½
  âœ… ë¶ˆí•„ìš”í•œ ê¸°ëŠ¥ ë¹„í™œì„±í™”
  âœ… ë³´ì•ˆ í—¤ë” ì„¤ì •

A6: Vulnerable and Outdated Components
  âœ… ì˜ì¡´ì„± ìµœì‹  ë²„ì „ ìœ ì§€
  âœ… ì •ê¸°ì  ë³´ì•ˆ íŒ¨ì¹˜ ì ìš©
  âœ… Dependency check ìë™í™”

A7: Authentication Failures
  âœ… ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ ì •ì±…
  âœ… MFA (Multi-Factor Auth) ì§€ì›
  âœ… Session ë³´ì•ˆ

A8: Software and Data Integrity Failures
  âœ… ì„œëª…ëœ ì—…ë°ì´íŠ¸ ë°°í¬
  âœ… ì•ˆì „í•œ CI/CD íŒŒì´í”„ë¼ì¸
  âœ… ì½”ë“œ ì„œëª… (git)

A9: Logging and Monitoring Failures
  âœ… ëª¨ë“  ë³´ì•ˆ ì´ë²¤íŠ¸ ë¡œê¹…
  âœ… ì‹¤ì‹œê°„ ì•Œë¦¼ ì„¤ì •
  âœ… ê°ì‚¬ ë¡œê·¸ ë³´ê´€

A10: SSRF (Server-Side Request Forgery)
  âœ… ë‚´ë¶€ IP ë²”ìœ„ ì°¨ë‹¨
  âœ… DNS rebinding ë°©ì§€
  âœ… URL ìœ íš¨ì„± ê²€ì¦
```

### ìë™ ë³´ì•ˆ ìŠ¤ìº”

```bash
$ /alfred:2-run SPEC-XXX --security-scan

Security Scan:
  ğŸ” SAST (Static Application Security Testing)
    - bandit: Python ë³´ì•ˆ ë¬¸ì œ ê²€ì‚¬
    - semgrep: íŒ¨í„´ ê¸°ë°˜ ì·¨ì•½ì  ê²€ì‚¬
    - npm audit: ì˜ì¡´ì„± ì·¨ì•½ì  ê²€ì‚¬
  
  âœ… Results:
    âœ… SQL Injection: 0 issues
    âœ… XSS: 0 issues
    âš ï¸ Hardcoded Secrets: 1 warning
    âœ… Weak Cryptography: 0 issues
```

---

## ğŸ“Š Part 3: ëª¨ë‹ˆí„°ë§ & ë¡œê¹…

### êµ¬ì¡°í™”ëœ ë¡œê¹…

```python
import json
from datetime import datetime

# âœ… ì¢‹ì€ ì˜ˆ: êµ¬ì¡°í™”ëœ ë¡œê·¸
logger.info(json.dumps({
    "timestamp": datetime.utcnow().isoformat(),
    "event": "user_login",
    "user_id": 123,
    "ip_address": "192.168.1.1",
    "success": True,
    "duration_ms": 120
}))

# âŒ ë‚˜ìœ ì˜ˆ: ììœ í˜• ë¡œê·¸
logger.info(f"User 123 logged in from 192.168.1.1")
```

### ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìˆ˜ì§‘

```python
import time
from prometheus_client import Histogram, Counter

# ì‘ë‹µ ì‹œê°„ ì¶”ì 
request_duration = Histogram(
    'http_request_duration_seconds',
    'Request duration in seconds',
    ['method', 'endpoint']
)

# ìš”ì²­ ìˆ˜ ì¶”ì 
request_count = Counter(
    'http_requests_total',
    'Total HTTP requests',
    ['method', 'endpoint', 'status']
)

@app.route('/api/products')
def list_products():
    with request_duration.labels('GET', '/products').time():
        products = Product.query.all()
        request_count.labels('GET', '/products', '200').inc()
        return products
```

### ì•ŒëŒ ê·œì¹™

```yaml
AlertRules:
  # ì„±ëŠ¥
  - name: HighLatency
    condition: "p95_latency > 200ms"
    severity: warning
    action: notify_team

  - name: HighErrorRate
    condition: "error_rate > 5%"
    severity: critical
    action: page_oncall

  # ë³´ì•ˆ
  - name: MultipleFailedLogins
    condition: "failed_logins > 5 in 5min"
    severity: warning
    action: block_ip, notify_security

  - name: UnauthorizedAccess
    condition: "401_errors > 10 in 1min"
    severity: critical
    action: investigate, block_ip

  # ë¦¬ì†ŒìŠ¤
  - name: HighMemoryUsage
    condition: "memory > 80%"
    severity: warning
    action: restart_service, notify_team

  - name: DiskFull
    condition: "disk_usage > 95%"
    severity: critical
    action: page_oncall
```

---

## ğŸ§ª Part 4: í…ŒìŠ¤íŠ¸ & ê²€ì¦

### ë¶€í•˜ í…ŒìŠ¤íŠ¸ (Load Testing)

```bash
$ locust -f locustfile.py --users 1000 --spawn-rate 100

Locust Results:
  ğŸ“Š Concurrent Users: 1000
  ğŸ“Š RPS: 5,000 req/s
  
  Response Times:
    - Min: 10ms
    - Max: 500ms
    - Median (p50): 50ms
    - p95: 150ms âœ… (< 200ms ëª©í‘œ)
    - p99: 300ms âœ…
  
  Error Rate: 0.1% âœ… (< 1% ëª©í‘œ)
  
  Bottleneck: Database connection pool (20 â†’ 50 ê¶Œì¥)
```

### ë³´ì•ˆ í…ŒìŠ¤íŠ¸

```python
# tests/security/test_injection.py

def test_sql_injection():
    """SQL injection ë°©ì§€"""
    malicious_input = "'; DROP TABLE users; --"
    
    # âŒ ì·¨ì•½í•œ ì½”ë“œ
    # query = f"SELECT * FROM users WHERE name = '{malicious_input}'"
    
    # âœ… ì•ˆì „í•œ ì½”ë“œ
    query = "SELECT * FROM users WHERE name = %s"
    user = db.execute(query, (malicious_input,))
    
    # í…Œì´ë¸”ì´ ì—¬ì „íˆ ì¡´ì¬í•´ì•¼ í•¨
    assert db.execute("SELECT COUNT(*) FROM users")[0] > 0

def test_rate_limiting():
    """Rate limitingì´ ì‘ë™í•˜ëŠ”ê°€?"""
    for i in range(101):  # 100 + 1
        response = client.get("/api/login")
    
    # 101ë²ˆì§¸ ìš”ì²­ì€ 429 (Too Many Requests)
    assert response.status_code == 429
```

---

## âœ… ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Pre-Production

```
ì„±ëŠ¥:
  â˜‘ï¸ P95 latency ëª©í‘œ ë‹¬ì„±
  â˜‘ï¸ Error rate < 1%
  â˜‘ï¸ Memory leak ì—†ìŒ
  â˜‘ï¸ ìºì‹œ hit rate > 80%

ë³´ì•ˆ:
  â˜‘ï¸ OWASP Top 10 ì²´í¬ ì™„ë£Œ
  â˜‘ï¸ ì˜ì¡´ì„± ë³´ì•ˆ ì—…ë°ì´íŠ¸
  â˜‘ï¸ SAST ìŠ¤ìº” í†µê³¼
  â˜‘ï¸ Secrets ì œê±°ë¨
  â˜‘ï¸ TLS ì„¤ì • ì™„ë£Œ

ëª¨ë‹ˆí„°ë§:
  â˜‘ï¸ Logging êµ¬ì¡°í™”ë¨
  â˜‘ï¸ Metrics ìˆ˜ì§‘ ì¤‘
  â˜‘ï¸ Alerting ê·œì¹™ ì„¤ì •
  â˜‘ï¸ Dashboard ìƒì„±ë¨

í…ŒìŠ¤íŠ¸:
  â˜‘ï¸ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 85%+ ì»¤ë²„ë¦¬ì§€
  â˜‘ï¸ í†µí•© í…ŒìŠ¤íŠ¸ ì™„ë£Œ
  â˜‘ï¸ ë¶€í•˜ í…ŒìŠ¤íŠ¸ í†µê³¼
  â˜‘ï¸ ë³´ì•ˆ í…ŒìŠ¤íŠ¸ í†µê³¼
```

---

## ğŸ“š Best Practices

### ì„±ëŠ¥

- âœ… ì¸¡ì • ë¨¼ì € (Measure first)
- âœ… ìºì‹œ í™œìš©
- âœ… ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”
- âœ… N+1 ì¿¼ë¦¬ ë°©ì§€
- âœ… ì •ê¸°ì  ë²¤ì¹˜ë§ˆí¬

### ë³´ì•ˆ

- âœ… ê¸°ë³¸ê°’ ì•ˆì „í•˜ê²Œ ì„¤ì •
- âœ… ì •ê¸°ì  ì—…ë°ì´íŠ¸
- âœ… ìµœì†Œ ê¶Œí•œ ì›ì¹™
- âœ… ë¡œê¹… & ëª¨ë‹ˆí„°ë§
- âœ… ê³µìœ  ì±…ì„ ëª¨ë¸

---

## ğŸ“– ì°¸ê³  ìë£Œ

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [TRUST 5 Principles](/ko/concepts/trust)
- [Hooks System](/ko/concepts/hooks-system)
- [Agent System](/ko/agents/overview)

