# @CODE:SECURITY-001 | ë³´ì•ˆ ìŠ¤ìº” ì›Œí¬í”Œë¡œìš°
name: Security Scan

on:
  push:
    branches: [main, develop, feature/**]
  pull_request:

jobs:
  security:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.13'

      - name: Install security tools
        run: |
          pip install pip-audit bandit

      - name: Run pip-audit (dependency vulnerability scan)
        run: |
          echo "ğŸ” Scanning dependencies for known vulnerabilities..."
          pip-audit --ignore-vuln GHSA-4xh5-x5gv-qwph || {
            echo "âš ï¸ pip-audit detected vulnerabilities"
            echo "Please review the vulnerabilities above and update dependencies"
            exit 1
          }
        continue-on-error: false
        # Note: GHSA-4xh5-x5gv-qwph (pip 25.2 tarfile extraction vulnerability)
        # is ignored as the fix is planned for pip 25.3 (not yet released)

      - name: Run bandit (code security scan)
        run: |
          echo "ğŸ” Scanning code for security issues..."
          bandit -r src/ -ll
        continue-on-error: false

      - name: Security scan summary
        if: success()
        run: |
          echo "âœ… All security scans passed!"
